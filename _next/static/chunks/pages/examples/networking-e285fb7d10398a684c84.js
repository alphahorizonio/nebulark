_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[9],{"1OyB":function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},BsWD:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("a3WO");function a(e,t){if(e){if("string"===typeof e)return Object(r.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(e,t):void 0}}},"HaE+":function(e,t,n){"use strict";function r(e,t,n,r,a,c,o){try{var s=e[c](o),i=s.value}catch(u){return void n(u)}s.done?t(i):Promise.resolve(i).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,c){var o=e.apply(t,n);function s(e){r(o,a,c,s,i,"next",e)}function i(e){r(o,a,c,s,i,"throw",e)}s(void 0)}))}}n.d(t,"a",(function(){return a}))},KQm4:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("a3WO");var a=n("BsWD");function c(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(a.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},ODXe:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("BsWD");function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,c=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(i){a=!0,c=i}finally{try{r||null==s.return||s.return()}finally{if(a)throw c}}return n}}(e,t)||Object(r.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},"U2S/":function(e,t,n){"use strict";function r(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}n.d(t,"a",(function(){return r}))},Vq6u:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/examples/networking",function(){return n("tJFt")}])},YFqc:function(e,t,n){e.exports=n("cTJO")},a3WO:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))},cTJO:function(e,t,n){"use strict";var r=n("J4zp"),a=n("284h");t.__esModule=!0,t.default=void 0;var c,o=a(n("q1tI")),s=n("elyg"),i=n("nOHt"),u=new Map,l=window.IntersectionObserver,f={};var b=function(e,t){var n=c||(l?c=new l((function(e){e.forEach((function(e){if(u.has(e.target)){var t=u.get(e.target);(e.isIntersecting||e.intersectionRatio>0)&&(c.unobserve(e.target),u.delete(e.target),t())}}))}),{rootMargin:"200px"}):void 0);return n?(n.observe(e),u.set(e,t),function(){try{n.unobserve(e)}catch(t){console.error(t)}u.delete(e)}):function(){}};function d(e,t,n,r){(0,s.isLocalURL)(t)&&(e.prefetch(t,n,r).catch((function(e){0})),f[t+"%"+n]=!0)}var j=function(e){var t=!1!==e.prefetch,n=o.default.useState(),a=r(n,2),c=a[0],u=a[1],j=(0,i.useRouter)(),p=j&&j.pathname||"/",O=o.default.useMemo((function(){var t=(0,s.resolveHref)(p,e.href,!0),n=r(t,2),a=n[0],c=n[1];return{href:a,as:e.as?(0,s.resolveHref)(p,e.as):c||a}}),[p,e.href,e.as]),h=O.href,v=O.as;o.default.useEffect((function(){if(t&&l&&c&&c.tagName&&(0,s.isLocalURL)(h)&&!f[h+"%"+v])return b(c,(function(){d(j,h,v)}))}),[t,c,h,v,j]);var w=e.children,g=e.replace,x=e.shallow,m=e.scroll;"string"===typeof w&&(w=o.default.createElement("a",null,w));var y=o.Children.only(w),k={ref:function(e){e&&u(e),y&&"object"===typeof y&&y.ref&&("function"===typeof y.ref?y.ref(e):"object"===typeof y.ref&&(y.ref.current=e))},onClick:function(e){y.props&&"function"===typeof y.props.onClick&&y.props.onClick(e),e.defaultPrevented||function(e,t,n,r,a,c,o){("A"!==e.currentTarget.nodeName||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&(0,s.isLocalURL)(n))&&(e.preventDefault(),null==o&&(o=r.indexOf("#")<0),t[a?"replace":"push"](n,r,{shallow:c}).then((function(e){e&&o&&(window.scrollTo(0,0),document.body.focus())})))}(e,j,h,v,g,x,m)}};return t&&(k.onMouseEnter=function(e){(0,s.isLocalURL)(h)&&(y.props&&"function"===typeof y.props.onMouseEnter&&y.props.onMouseEnter(e),d(j,h,v,{priority:!0}))}),(e.passHref||"a"===y.type&&!("href"in y.props))&&(k.href=(0,s.addBasePath)((0,s.addLocale)(v,j&&j.locale,j&&j.defaultLocale))),o.default.cloneElement(y,k)};t.default=j},m9EI:function(e,t,n){"use strict";function r(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}n.d(t,"a",(function(){return r}))},rePB:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))},tJFt:function(e,t,n){"use strict";n.r(t);var r,a,c,o,s,i=n("o0o1"),u=n.n(i),l=n("HaE+"),f=n("KQm4"),b=n("ODXe"),d=n("nKUr"),j=n("YFqc"),p=n.n(j),O=n("q1tI"),h=n.n(O),v=n("1OyB"),w=n("rePB"),g=n("U2S/"),x=n("m9EI"),m=new WeakMap,y=new WeakMap,k=new WeakMap,C=new WeakMap,S=new WeakMap,M=new WeakMap,E=new WeakMap,D=new WeakMap,T=function e(t,n,r,a,c){var o=this;Object(v.a)(this,e),m.set(this,{writable:!0,value:{}}),y.set(this,{writable:!0,value:""}),k.set(this,{writable:!0,value:void 0}),C.set(this,{writable:!0,value:void 0}),S.set(this,{writable:!0,value:void 0}),M.set(this,{writable:!0,value:function(){}}),E.set(this,{writable:!0,value:function(){}}),D.set(this,{writable:!0,value:function(){}}),Object(w.a)(this,"getConnectionInfo",function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(l.a)(u.a.mark((function e(n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=Object(g.a)(o,y),e.next=0===e.t0?3:1===e.t0?14:23;break;case 3:return Object(x.a)(o,k,new RTCPeerConnection(Object(g.a)(o,m))),Object(g.a)(o,k).onicecandidate=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.candidate||n(Object(g.a)(o,k).localDescription);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Object(x.a)(o,C,Object(g.a)(o,k).createDataChannel("sendChannel")),Object(g.a)(o,C).onopen=Object(g.a)(o,M),Object(g.a)(o,C).onmessage=Object(g.a)(o,E),Object(g.a)(o,C).onclose=Object(g.a)(o,D),e.next=11,Object(g.a)(o,k).createOffer();case 11:return r=e.sent,Object(g.a)(o,k).setLocalDescription(r),e.abrupt("break",23);case 14:return Object(x.a)(o,k,new RTCPeerConnection(Object(g.a)(o,m))),Object(g.a)(o,k).onicecandidate=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.candidate||n(Object(g.a)(o,k).localDescription);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Object(g.a)(o,k).setRemoteDescription(t),Object(g.a)(o,k).ondatachannel=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(x.a)(o,S,t),Object(g.a)(o,S).channel.onopen=Object(g.a)(o,M),Object(g.a)(o,S).channel.onmessage=Object(g.a)(o,E),Object(g.a)(o,S).channel.onclose=Object(g.a)(o,D);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=20,Object(g.a)(o,k).createAnswer();case 20:return a=e.sent,Object(g.a)(o,k).setLocalDescription(a),e.abrupt("break",23);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(w.a)(this,"connect",function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0===Object(g.a)(o,y)&&Object(g.a)(o,k).setRemoteDescription(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(w.a)(this,"sendMessage",function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=Object(g.a)(o,y),e.next=0===e.t0?3:1===e.t0?6:9;break;case 3:return e.next=5,Object(g.a)(o,C).send(t);case 5:return e.abrupt("break",9);case 6:return e.next=8,Object(g.a)(o,S).channel.send(t);case 8:return e.abrupt("break",9);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(x.a)(this,m,t),Object(x.a)(this,y,n),Object(x.a)(this,M,r),Object(x.a)(this,E,a),Object(x.a)(this,D,c)};Object(w.a)(T,"Builder",(r=new WeakMap,a=new WeakMap,c=new WeakMap,o=new WeakMap,s=new WeakMap,function(){return function e(){var t=this;Object(v.a)(this,e),r.set(this,{writable:!0,value:{}}),a.set(this,{writable:!0,value:0}),c.set(this,{writable:!0,value:function(){}}),o.set(this,{writable:!0,value:function(){}}),s.set(this,{writable:!0,value:function(){}}),Object(w.a)(this,"setConfig",(function(e){return Object(x.a)(t,r,e),t})),Object(w.a)(this,"useManager",(function(){return Object(x.a)(t,a,0),t})),Object(w.a)(this,"useWorker",(function(){return Object(x.a)(t,a,1),t})),Object(w.a)(this,"setOnMessage",(function(e){return Object(x.a)(t,o,e),t})),Object(w.a)(this,"setOnConnect",(function(e){return Object(x.a)(t,c,e),t})),Object(w.a)(this,"setOnDisconnect",(function(e){return Object(x.a)(t,s,e),t})),Object(w.a)(this,"build",(function(){return new T(Object(g.a)(t,r),Object(g.a)(t,a),Object(g.a)(t,c),Object(g.a)(t,o),Object(g.a)(t,s))}))}}()));t.default=function(){var e=h.a.useState(),t=Object(b.a)(e,2),n=t[0],r=t[1],a=h.a.useState(),c=Object(b.a)(a,2),o=c[0],s=c[1],i=h.a.useState([]),j=Object(b.a)(i,2),O=j[0],v=j[1],w=h.a.useState([]),g=Object(b.a)(w,2),x=g[0],m=g[1],y=h.a.useState(!1),k=Object(b.a)(y,2),C=k[0],S=k[1],M=h.a.useState(!1),E=Object(b.a)(M,2),D=E[0],W=E[1],I=h.a.useState(""),R=Object(b.a)(I,2),B=R[0],_=R[1],A=h.a.useState(""),L=Object(b.a)(A,2),P=L[0],q=L[1],U=h.a.useState(""),H=Object(b.a)(U,2),N=H[0],J=H[1],K=h.a.useState(""),X=Object(b.a)(K,2),F=X[0],V=X[1],Y=h.a.useState(""),G=Object(b.a)(Y,2),Z=G[0],Q=G[1],z=h.a.useState(""),$=Object(b.a)(z,2),ee=$[0],te=$[1],ne={iceServers:[{url:"stun:global.stun.twilio.com:3478?transport=udp",urls:"stun:global.stun.twilio.com:3478?transport=udp"},{url:"turn:global.turn.twilio.com:3478?transport=udp",username:"cd4dfc8127082a04b865f5607c031410726df919c4ced0f93619be0ed2b811b3",urls:"turn:global.turn.twilio.com:3478?transport=udp",credential:"h/sD5UftD1H2Tjlux/u6kqdqsIleXtEEZthVgY/BciA="},{url:"turn:global.turn.twilio.com:3478?transport=tcp",username:"cd4dfc8127082a04b865f5607c031410726df919c4ced0f93619be0ed2b811b3",urls:"turn:global.turn.twilio.com:3478?transport=tcp",credential:"h/sD5UftD1H2Tjlux/u6kqdqsIleXtEEZthVgY/BciA="},{url:"turn:global.turn.twilio.com:443?transport=tcp",username:"cd4dfc8127082a04b865f5607c031410726df919c4ced0f93619be0ed2b811b3",urls:"turn:global.turn.twilio.com:443?transport=tcp",credential:"h/sD5UftD1H2Tjlux/u6kqdqsIleXtEEZthVgY/BciA="}]};return h.a.useState((function(){r((new T.Builder).setConfig(ne).useManager().setOnConnect((function(){console.log("connected"),S(!0)})).setOnMessage((function(e){console.log("received message"),v((function(t){return[].concat(Object(f.a)(t),["[".concat((new Date).toLocaleString(),"] <receiver> ").concat(atob(e.data))])}))})).setOnDisconnect((function(){console.log("disconnected"),S(!1)})).build()),s((new T.Builder).setConfig(ne).useWorker().setOnConnect((function(){console.log("connected"),W(!0)})).setOnMessage((function(e){console.log("received message"),m((function(t){return[].concat(Object(f.a)(t),["[".concat((new Date).toLocaleString(),"] <sender> ").concat(atob(e.data))])}))})).setOnDisconnect((function(){console.log("disconnected"),W(!1)})).build())}),[]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(p.a,{href:"/",children:"\ud83d\udd19 Back"}),Object(d.jsx)("h1",{children:"Nebulark Networking Examples"}),Object(d.jsxs)("section",{id:"instructions",children:[Object(d.jsx)("h2",{children:"Instructions"}),Object(d.jsxs)("em",{children:["Please ensure that you are in a ",Object(d.jsx)("strong",{children:"secure context"})," (i.e. a HTTPS secured page or localhost), otherwise the examples below won't work."]}),Object(d.jsxs)("ol",{children:[Object(d.jsx)("li",{children:"Generate offer on sender"}),Object(d.jsx)("li",{children:"Copy offer to receiver"}),Object(d.jsx)("li",{children:"Generate answer on receiver (on this page, on this page in another tab, on another device, ...)"}),Object(d.jsx)("li",{children:"Copy answer to sender"}),Object(d.jsx)("li",{children:"Connect to receiver from sender"})]})]}),Object(d.jsx)("section",{id:"sender",children:Object(d.jsxs)("details",{children:[Object(d.jsx)("summary",{children:"Sender"}),Object(d.jsx)("h2",{children:"Sender"}),Object(d.jsx)("button",{onClick:Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("generating offer"),e.t0=_,e.t1=btoa,e.next=5,n.getConnectionInfo();case 5:e.t2=e.sent.sdp,e.t3=(0,e.t1)(e.t2),(0,e.t0)(e.t3);case 8:case"end":return e.stop()}}),e)}))),children:"Generate offer"}),Object(d.jsx)("br",{}),Object(d.jsx)("textarea",{placeholder:"Sender's offer",value:B,readOnly:!0,rows:"5",cols:"50"}),Object(d.jsx)("br",{}),Object(d.jsx)("textarea",{placeholder:"Receiver's answer",rows:"5",cols:"50",value:N,onChange:function(e){return J(e.target.value)}}),Object(d.jsx)("br",{}),Object(d.jsx)("button",{onClick:function(){console.log("connecting"),n.connect(new RTCSessionDescription({type:"answer",sdp:atob(N)}))},children:"Connect to receiver"}),Object(d.jsx)("span",{children:C?"\u2705 Connected":"\u274c Disconnected"}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"text",placeholder:"Message to send to receiver",value:Z,onChange:function(e){return Q(e.target.value)}}),Object(d.jsx)("button",{onClick:function(){Q(""),n.sendMessage(btoa(Z))},children:"Send message to receiver"}),Object(d.jsx)("br",{}),Object(d.jsx)("h3",{children:"Messages"}),Object(d.jsx)("ul",{children:O.map((function(e,t){return Object(d.jsx)("li",{children:e},t)}))})]})}),Object(d.jsx)("section",{id:"receiver",children:Object(d.jsxs)("details",{children:[Object(d.jsx)("summary",{children:"Receiver"}),Object(d.jsx)("h2",{children:"Receiver"}),Object(d.jsx)("textarea",{placeholder:"Sender's offer",value:P,onChange:function(e){return q(e.target.value)},rows:"5",cols:"50"}),Object(d.jsx)("br",{}),Object(d.jsx)("button",{onClick:Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("generating answer"),e.t0=V,e.t1=btoa,e.next=5,o.getConnectionInfo(new RTCSessionDescription({type:"offer",sdp:atob(P)}));case 5:e.t2=e.sent.sdp,e.t3=(0,e.t1)(e.t2),(0,e.t0)(e.t3);case 8:case"end":return e.stop()}}),e)}))),children:"Generate answer"}),Object(d.jsx)("br",{}),Object(d.jsx)("textarea",{placeholder:"Receiver's answer",value:F,readOnly:!0,rows:"5",cols:"50"}),Object(d.jsx)("br",{}),Object(d.jsx)("span",{children:D?"\u2705 Connected":"\u274c Disconnected"}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"text",placeholder:"Message to send to sender",value:ee,onChange:function(e){return te(e.target.value)}}),Object(d.jsx)("button",{onClick:function(){te(""),o.sendMessage(btoa(ee))},children:"Send message to sender"}),Object(d.jsx)("br",{}),Object(d.jsx)("h3",{children:"Messages"}),Object(d.jsx)("ul",{children:x.map((function(e,t){return Object(d.jsx)("li",{children:e},t)}))})]})})]})}}},[["Vq6u",0,2,1]]]);