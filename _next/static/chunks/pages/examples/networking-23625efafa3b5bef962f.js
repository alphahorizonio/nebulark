_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[18],{"1OyB":function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},BsWD:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("a3WO");function a(e,t){if(e){if("string"===typeof e)return Object(r.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(e,t):void 0}}},"HaE+":function(e,t,n){"use strict";function r(e,t,n,r,a,c,o){try{var s=e[c](o),i=s.value}catch(u){return void n(u)}s.done?t(i):Promise.resolve(i).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,c){var o=e.apply(t,n);function s(e){r(o,a,c,s,i,"next",e)}function i(e){r(o,a,c,s,i,"throw",e)}s(void 0)}))}}n.d(t,"a",(function(){return a}))},KQm4:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n("a3WO");var a=n("BsWD");function c(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(a.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},ODXe:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("BsWD");function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,c=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(i){a=!0,c=i}finally{try{r||null==s.return||s.return()}finally{if(a)throw c}}return n}}(e,t)||Object(r.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},"U2S/":function(e,t,n){"use strict";function r(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}n.d(t,"a",(function(){return r}))},Vq6u:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/examples/networking",function(){return n("tJFt")}])},YFqc:function(e,t,n){e.exports=n("cTJO")},a3WO:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))},cTJO:function(e,t,n){"use strict";var r=n("J4zp"),a=n("284h");t.__esModule=!0,t.default=void 0;var c,o=a(n("q1tI")),s=n("elyg"),i=n("nOHt"),u=new Map,l=window.IntersectionObserver,b={};var f=function(e,t){var n=c||(l?c=new l((function(e){e.forEach((function(e){if(u.has(e.target)){var t=u.get(e.target);(e.isIntersecting||e.intersectionRatio>0)&&(c.unobserve(e.target),u.delete(e.target),t())}}))}),{rootMargin:"200px"}):void 0);return n?(n.observe(e),u.set(e,t),function(){try{n.unobserve(e)}catch(t){console.error(t)}u.delete(e)}):function(){}};function j(e,t,n,r){(0,s.isLocalURL)(t)&&(e.prefetch(t,n,r).catch((function(e){0})),b[t+"%"+n]=!0)}var d=function(e){var t=!1!==e.prefetch,n=o.default.useState(),a=r(n,2),c=a[0],u=a[1],d=(0,i.useRouter)(),p=d&&d.pathname||"/",O=o.default.useMemo((function(){var t=(0,s.resolveHref)(p,e.href,!0),n=r(t,2),a=n[0],c=n[1];return{href:a,as:e.as?(0,s.resolveHref)(p,e.as):c||a}}),[p,e.href,e.as]),h=O.href,w=O.as;o.default.useEffect((function(){if(t&&l&&c&&c.tagName&&(0,s.isLocalURL)(h)&&!b[h+"%"+w])return f(c,(function(){j(d,h,w)}))}),[t,c,h,w,d]);var g=e.children,v=e.replace,m=e.shallow,x=e.scroll;"string"===typeof g&&(g=o.default.createElement("a",null,g));var y=o.Children.only(g),k={ref:function(e){e&&u(e),y&&"object"===typeof y&&y.ref&&("function"===typeof y.ref?y.ref(e):"object"===typeof y.ref&&(y.ref.current=e))},onClick:function(e){y.props&&"function"===typeof y.props.onClick&&y.props.onClick(e),e.defaultPrevented||function(e,t,n,r,a,c,o){("A"!==e.currentTarget.nodeName||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&(0,s.isLocalURL)(n))&&(e.preventDefault(),null==o&&(o=r.indexOf("#")<0),t[a?"replace":"push"](n,r,{shallow:c}).then((function(e){e&&o&&(window.scrollTo(0,0),document.body.focus())})))}(e,d,h,w,v,m,x)}};return t&&(k.onMouseEnter=function(e){(0,s.isLocalURL)(h)&&(y.props&&"function"===typeof y.props.onMouseEnter&&y.props.onMouseEnter(e),j(d,h,w,{priority:!0}))}),(e.passHref||"a"===y.type&&!("href"in y.props))&&(k.href=(0,s.addBasePath)((0,s.addLocale)(w,d&&d.locale,d&&d.defaultLocale))),o.default.cloneElement(y,k)};t.default=d},m9EI:function(e,t,n){"use strict";function r(e,t,n){var r=t.get(e);if(!r)throw new TypeError("attempted to set private field on non-instance");if(r.set)r.set.call(e,n);else{if(!r.writable)throw new TypeError("attempted to set read only private field");r.value=n}return n}n.d(t,"a",(function(){return r}))},rePB:function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))},tJFt:function(e,t,n){"use strict";n.r(t);var r,a,c,o,s,i=n("o0o1"),u=n.n(i),l=n("HaE+"),b=n("KQm4"),f=n("ODXe"),j=n("nKUr"),d=n("YFqc"),p=n.n(d),O=n("q1tI"),h=n.n(O),w=n("1OyB"),g=n("rePB"),v=n("U2S/"),m=n("m9EI"),x=new WeakMap,y=new WeakMap,k=new WeakMap,C=new WeakMap,M=new WeakMap,S=new WeakMap,E=new WeakMap,D=new WeakMap,W=function e(t,n,r,a,c){var o=this;Object(w.a)(this,e),x.set(this,{writable:!0,value:{}}),y.set(this,{writable:!0,value:""}),k.set(this,{writable:!0,value:void 0}),C.set(this,{writable:!0,value:void 0}),M.set(this,{writable:!0,value:void 0}),S.set(this,{writable:!0,value:function(){}}),E.set(this,{writable:!0,value:function(){}}),D.set(this,{writable:!0,value:function(){}}),Object(g.a)(this,"getConnectionInfo",function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Object(l.a)(u.a.mark((function e(n){var r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=Object(v.a)(o,y),e.next=0===e.t0?3:1===e.t0?14:23;break;case 3:return Object(m.a)(o,k,new RTCPeerConnection(Object(v.a)(o,x))),Object(v.a)(o,k).onicecandidate=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.candidate||n(Object(v.a)(o,k).localDescription);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Object(m.a)(o,C,Object(v.a)(o,k).createDataChannel("sendChannel")),Object(v.a)(o,C).onopen=Object(v.a)(o,S),Object(v.a)(o,C).onmessage=Object(v.a)(o,E),Object(v.a)(o,C).onclose=Object(v.a)(o,D),e.next=11,Object(v.a)(o,k).createOffer();case 11:return r=e.sent,Object(v.a)(o,k).setLocalDescription(r),e.abrupt("break",23);case 14:return Object(m.a)(o,k,new RTCPeerConnection(Object(v.a)(o,x))),Object(v.a)(o,k).onicecandidate=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.candidate||n(Object(v.a)(o,k).localDescription);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Object(v.a)(o,k).setRemoteDescription(t),Object(v.a)(o,k).ondatachannel=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(m.a)(o,M,t),Object(v.a)(o,M).channel.onopen=Object(v.a)(o,S),Object(v.a)(o,M).channel.onmessage=Object(v.a)(o,E),Object(v.a)(o,M).channel.onclose=Object(v.a)(o,D);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=20,Object(v.a)(o,k).createAnswer();case 20:return a=e.sent,Object(v.a)(o,k).setLocalDescription(a),e.abrupt("break",23);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(g.a)(this,"connect",function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:0===Object(v.a)(o,y)&&Object(v.a)(o,k).setRemoteDescription(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(g.a)(this,"sendMessage",function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=Object(v.a)(o,y),e.next=0===e.t0?3:1===e.t0?6:9;break;case 3:return e.next=5,Object(v.a)(o,C).send(t);case 5:return e.abrupt("break",9);case 6:return e.next=8,Object(v.a)(o,M).channel.send(t);case 8:return e.abrupt("break",9);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Object(m.a)(this,x,t),Object(m.a)(this,y,n),Object(m.a)(this,S,r),Object(m.a)(this,E,a),Object(m.a)(this,D,c)};Object(g.a)(W,"Builder",(r=new WeakMap,a=new WeakMap,c=new WeakMap,o=new WeakMap,s=new WeakMap,function(){return function e(){var t=this;Object(w.a)(this,e),r.set(this,{writable:!0,value:{}}),a.set(this,{writable:!0,value:0}),c.set(this,{writable:!0,value:function(){}}),o.set(this,{writable:!0,value:function(){}}),s.set(this,{writable:!0,value:function(){}}),Object(g.a)(this,"setConfig",(function(e){return Object(m.a)(t,r,e),t})),Object(g.a)(this,"useManager",(function(){return Object(m.a)(t,a,0),t})),Object(g.a)(this,"useWorker",(function(){return Object(m.a)(t,a,1),t})),Object(g.a)(this,"setOnMessage",(function(e){return Object(m.a)(t,o,e),t})),Object(g.a)(this,"setOnConnect",(function(e){return Object(m.a)(t,c,e),t})),Object(g.a)(this,"setOnDisconnect",(function(e){return Object(m.a)(t,s,e),t})),Object(g.a)(this,"build",(function(){return new W(Object(v.a)(t,r),Object(v.a)(t,a),Object(v.a)(t,c),Object(v.a)(t,o),Object(v.a)(t,s))}))}}()));t.default=function(){var e=h.a.useState(),t=Object(f.a)(e,2),n=t[0],r=t[1],a=h.a.useState(),c=Object(f.a)(a,2),o=c[0],s=c[1],i=h.a.useState([]),d=Object(f.a)(i,2),O=d[0],w=d[1],g=h.a.useState([]),v=Object(f.a)(g,2),m=v[0],x=v[1],y=h.a.useState(!1),k=Object(f.a)(y,2),C=k[0],M=k[1],S=h.a.useState(!1),E=Object(f.a)(S,2),D=E[0],T=E[1],I=h.a.useState(""),B=Object(f.a)(I,2),_=B[0],A=B[1],L=h.a.useState(""),P=Object(f.a)(L,2),q=P[0],R=P[1],U=h.a.useState(""),H=Object(f.a)(U,2),N=H[0],F=H[1],J=h.a.useState(""),K=Object(f.a)(J,2),X=K[0],V=K[1],Y=h.a.useState(""),G=Object(f.a)(Y,2),Z=G[0],Q=G[1],z=h.a.useState(""),$=Object(f.a)(z,2),ee=$[0],te=$[1],ne={iceServers:[{url:"stun:global.stun.twilio.com:3478?transport=udp",urls:"stun:global.stun.twilio.com:3478?transport=udp"},{url:"turn:global.turn.twilio.com:3478?transport=udp",username:"cd4dfc8127082a04b865f5607c031410726df919c4ced0f93619be0ed2b811b3",urls:"turn:global.turn.twilio.com:3478?transport=udp",credential:"h/sD5UftD1H2Tjlux/u6kqdqsIleXtEEZthVgY/BciA="},{url:"turn:global.turn.twilio.com:3478?transport=tcp",username:"cd4dfc8127082a04b865f5607c031410726df919c4ced0f93619be0ed2b811b3",urls:"turn:global.turn.twilio.com:3478?transport=tcp",credential:"h/sD5UftD1H2Tjlux/u6kqdqsIleXtEEZthVgY/BciA="},{url:"turn:global.turn.twilio.com:443?transport=tcp",username:"cd4dfc8127082a04b865f5607c031410726df919c4ced0f93619be0ed2b811b3",urls:"turn:global.turn.twilio.com:443?transport=tcp",credential:"h/sD5UftD1H2Tjlux/u6kqdqsIleXtEEZthVgY/BciA="}]};return h.a.useState((function(){r((new W.Builder).setConfig(ne).useManager().setOnConnect((function(){console.log("connected"),M(!0)})).setOnMessage((function(e){console.log("received message"),w((function(t){return[].concat(Object(b.a)(t),["[".concat((new Date).toLocaleString(),"] <worker> ").concat(atob(e.data))])}))})).setOnDisconnect((function(){console.log("disconnected"),M(!1)})).build()),s((new W.Builder).setConfig(ne).useWorker().setOnConnect((function(){console.log("connected"),T(!0)})).setOnMessage((function(e){console.log("received message"),x((function(t){return[].concat(Object(b.a)(t),["[".concat((new Date).toLocaleString(),"] <manager> ").concat(atob(e.data))])}))})).setOnDisconnect((function(){console.log("disconnected"),T(!1)})).build())}),[]),Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(p.a,{href:"/",children:"\ud83d\udd19 Back"}),Object(j.jsx)("h1",{children:"Nebulark Networking Examples"}),Object(j.jsxs)("section",{id:"instructions",children:[Object(j.jsx)("h2",{children:"Instructions"}),Object(j.jsxs)("em",{children:["Please ensure that you are in a ",Object(j.jsx)("strong",{children:"secure context"})," (i.e. a HTTPS secured page or localhost), otherwise the examples below might not work."]}),Object(j.jsxs)("ol",{children:[Object(j.jsx)("li",{children:"Generate offer on manager"}),Object(j.jsx)("li",{children:"Copy offer to worker"}),Object(j.jsx)("li",{children:"Generate answer on worker (on this page, on this page in another tab, on another device, ...)"}),Object(j.jsx)("li",{children:"Copy answer to manager"}),Object(j.jsx)("li",{children:"Connect to worker from manager"}),Object(j.jsx)("li",{children:"Try it out and send some messages back and forth!"})]})]}),Object(j.jsx)("section",{id:"manager",children:Object(j.jsxs)("details",{children:[Object(j.jsx)("summary",{children:"Manager"}),Object(j.jsx)("h2",{children:"Manager"}),Object(j.jsx)("button",{onClick:Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("generating offer"),e.t0=A,e.t1=btoa,e.next=5,n.getConnectionInfo();case 5:e.t2=e.sent.sdp,e.t3=(0,e.t1)(e.t2),(0,e.t0)(e.t3);case 8:case"end":return e.stop()}}),e)}))),children:"Generate offer"}),Object(j.jsx)("br",{}),Object(j.jsx)("textarea",{placeholder:"Manager's offer",value:_,readOnly:!0,rows:"5",cols:"50"}),Object(j.jsx)("br",{}),Object(j.jsx)("textarea",{placeholder:"Worker's answer",rows:"5",cols:"50",value:N,onChange:function(e){return F(e.target.value)}}),Object(j.jsx)("br",{}),Object(j.jsx)("button",{onClick:function(){console.log("connecting"),n.connect(new RTCSessionDescription({type:"answer",sdp:atob(N)}))},children:"Connect to worker"}),Object(j.jsx)("br",{}),C?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("span",{children:"\u2705 Connected"}),Object(j.jsx)("input",{type:"text",placeholder:"Message to send to worker",value:Z,onChange:function(e){return Q(e.target.value)}}),Object(j.jsx)("button",{onClick:function(){console.log("sending message"),Q(""),n.sendMessage(btoa(Z))},children:"Send message to worker"}),Object(j.jsx)("br",{}),Object(j.jsx)("h3",{children:"Messages"}),Object(j.jsx)("ul",{children:O.map((function(e,t){return Object(j.jsx)("li",{children:e},t)}))})]}):Object(j.jsx)("span",{children:"\u274c Disconnected"})]})}),Object(j.jsx)("section",{id:"worker",children:Object(j.jsxs)("details",{children:[Object(j.jsx)("summary",{children:"Worker"}),Object(j.jsx)("h2",{children:"Worker"}),Object(j.jsx)("textarea",{placeholder:"Manager's offer",value:q,onChange:function(e){return R(e.target.value)},rows:"5",cols:"50"}),Object(j.jsx)("br",{}),Object(j.jsx)("button",{onClick:Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("generating answer"),e.t0=V,e.t1=btoa,e.next=5,o.getConnectionInfo(new RTCSessionDescription({type:"offer",sdp:atob(q)}));case 5:e.t2=e.sent.sdp,e.t3=(0,e.t1)(e.t2),(0,e.t0)(e.t3);case 8:case"end":return e.stop()}}),e)}))),children:"Generate answer"}),Object(j.jsx)("br",{}),Object(j.jsx)("textarea",{placeholder:"Worker's answer",value:X,readOnly:!0,rows:"5",cols:"50"}),Object(j.jsx)("br",{}),D?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("span",{children:"\u2705 Connected"}),Object(j.jsx)("br",{}),Object(j.jsx)("input",{type:"text",placeholder:"Message to send to manager",value:ee,onChange:function(e){return te(e.target.value)}}),Object(j.jsx)("button",{onClick:function(){console.log("sending message"),te(""),o.sendMessage(btoa(ee))},children:"Send message to manager"}),Object(j.jsx)("br",{}),Object(j.jsx)("h3",{children:"Messages"}),Object(j.jsx)("ul",{children:m.map((function(e,t){return Object(j.jsx)("li",{children:e},t)}))})]}):Object(j.jsx)("span",{children:"\u274c Disconnected"})]})})]})}}},[["Vq6u",0,1,2,3]]]);