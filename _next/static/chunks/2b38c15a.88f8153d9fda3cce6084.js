(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[5],{"z/r+":function(e,t,r){"use strict";(function(e){const{custom:i}=r("9jQp"),f=r("lajS"),s=0,n=1,d=2,o=3,h=[-3,-1,-5,-7,0,7,5,1,3];let u=0;class c{constructor(e,t,r){this.Point=null,this.id=null,this.uid=u++,this.ossl=null,this.type="base",this.endian="be",this.hash=null,this.prefix=null,this.context=!1,this.prime=null,this.p=null,this.red=null,this.fieldSize=0,this.fieldBits=0,this.adjustedSize=0,this.signBit=0,this.mask=0,this.n=null,this.h=null,this.q=null,this.z=null,this.g=null,this.nh=null,this.scalarSize=0,this.scalarBits=0,this.zero=null,this.one=null,this.two=null,this.three=null,this.four=null,this.i2=null,this.i3=null,this.i4=null,this.i6=null,this.torsion=null,this.endo=null,this.hi=null,this._init(e,t,r)}_init(t,r,i){J("function"===typeof t),J("string"===typeof r),J(i&&"object"===typeof i),J(null==i.red||i.red instanceof f.Red),J(null!=i.p,"Must pass a prime."),J(null==i.id||"string"===typeof i.id),J(null==i.ossl||"string"===typeof i.ossl),J(null==i.endian||"string"===typeof i.endian),J(null==i.hash||"string"===typeof i.hash),J(null==i.prefix||"string"===typeof i.prefix),J(null==i.context||"boolean"===typeof i.context),J(null==i.prime||"string"===typeof i.prime),J(null==i.torsion||Array.isArray(i.torsion)),this.Point=t,this.id=i.id||null,this.ossl=i.ossl||null,this.type=r,this.endian=i.endian||("short"===r?"be":"le"),this.hash=i.hash||null,this.prefix=i.prefix?e.from(i.prefix,"binary"):null,this.context=i.context||!1,this.prime=i.prime||null,this.p=f.fromJSON(i.p),i.red?this.red=i.red:(this.red=i.prime?f.red(i.prime):f.mont(this.p),this.red.precompute()),this.fieldSize=this.p.byteLength(),this.fieldBits=this.p.bitLength(),this.adjustedSize=this.fieldSize+(0===(7&this.fieldBits)),this.signBit=8*this.adjustedSize-1,this.mask=255,0!==(7&this.fieldBits)&&(this.mask=(1<<(7&this.fieldBits))-1),this.n=f.fromJSON(i.n||"0"),this.h=f.fromJSON(i.h||"1"),this.q=this.n.mul(this.h),this.z=f.fromJSON(i.z||"0").toRed(this.red),this.g=null,this.nh=this.n.ushrn(1),this.scalarSize=this.n.byteLength(),this.scalarBits=this.n.bitLength(),this.zero=new f(0).toRed(this.red),this.one=new f(1).toRed(this.red),this.two=new f(2).toRed(this.red),this.three=new f(3).toRed(this.red),this.four=new f(4).toRed(this.red),this.i2=this.two.redInvert(),this.i3=this.three.redInvert(),this.i4=this.i2.redSqr(),this.i6=this.i2.redMul(this.i3),this.torsion=new Array(this.h.word(0));for(let e=0;e<this.torsion.length;e++)this.torsion[e]=this.point();return this.endo=null,this.hi=null,this._scale=X(this._scale,this),this.isIsomorphic=X(this.isIsomorphic,this),this.isIsogenous=X(this.isIsogenous,this),J(this.p.sign()>0&&this.p.isOdd()),J(this.n.sign()>=0),J(this.h.sign()>0&&this.h.cmpn(255)<=0),J("be"===this.endian||"le"===this.endian),this}_finalize(e){if(J(e&&"object"===typeof e),this.g=e.g?this.pointFromJSON(e.g):this.point(),e.torsion){J(e.torsion.length===this.torsion.length);for(let t=0;t<this.torsion.length;t++)this.torsion[t]=this.pointFromJSON(e.torsion[t])}return this}_findTorsion(){J(!this.n.isZero());const e=this.h.word(0),t=this.one.redNeg(),r=[this.point()],i=new Set;let f=e;for(;r.length<f;){let e;t.redIAdd(this.one);try{e=this.pointFromX(t.clone())}catch(s){continue}try{e=e.mul(this.n)}catch(s){f=2;continue}if(!e.isInfinity()){e.normalize();for(const t of[e,e.neg()]){const e=t.key();i.has(e)||(r.push(t),i.add(e))}}}for(r.sort((e,t)=>e.cmp(t));r.length<e;)r.push(this.point());return r}_simpleMul(e,t){J(e instanceof l),J(t instanceof f),J(!t.red);const r=t.bitLength();t.isNeg()&&(e=e.neg());let i=this.jpoint();for(let f=r-1;f>=0;f--){const r=t.bit(f);i=i.dbl(),1===r&&(i=i.add(e))}return i}_simpleMulAdd(e,t){J(Array.isArray(e)),J(Array.isArray(t)),J(e.length===t.length);const r=e.length,i=new Array(r),s=t;let n=0;for(let o=0;o<r;o++){const r=e[o],s=t[o];if(J(r instanceof l),J(s instanceof f),J(!s.red),o>0&&r.type!==e[o-1].type)throw new Error("Cannot mix points.");i[o]=s.isNeg()?r.neg():r,n=Math.max(n,s.bitLength())}let d=this.jpoint();for(let f=n-1;f>=0;f--){d=d.dbl();for(let e=0;e<r;e++){const t=i[e];1===s[e].bit(f)&&(d=d.add(t))}}return d}_constMul(e,t,r){return J(e instanceof l),this.n.isZero()?this._simpleMul(e,t):"short"===this.type&&0===this.h.cmpn(1)?this._coZLadderMul(e,t):this._ladderMul(e,t)}_ladderMul(e,t){J(e instanceof l),J(t instanceof f),J(!t.red);const[r,i,s]=function(e,t){J(e instanceof f),J(t instanceof f);const r=e.abs().add(t),i=r.add(t),s=r.bitLength(),n=t.bitLength();r.cinject(i,s-n-1>>>31);const d=1&e.isNeg(),o=r.bitLength(),h=r.toArray("le");return[d,o,h]}(t,this.q);let n=e.toJ().clone(),d=this.jpoint().clone(),o=0;for(let f=i-1;f>=0;f--){const e=s[f>>3]>>(7&f)&1;n.swap(d,o^e),n=n.uadd(d),d=d.udbl(),o=e}return n.swap(d,o),d.swap(d.neg(),r),d}_coZLadderMul(e,t){J(e instanceof l),J(t instanceof f),J(!t.red);const r=e.toJ().clone(),[i,s,n,d]=function(e,t){J(e instanceof f),J(t instanceof f);const r=e.mod(t),i=t.sub(r),s=r.bitLength(),n=i.bitLength(),d=s-n>>>31;r.cinject(i,d);const o=r.bitLength(),h=r.toArray("le"),u=r.ceq(t.subn(1));return[d,o,h,u]}(t,this.n);let[o,h]=r.zdblu(),u=0;for(let f=s-2;f>=0;f--){const e=n[f>>3]>>(7&f)&1;o.swap(h,u^e),[o,h]=h.zaddc(o),[h,o]=o.zaddu(h),u=e}return o.swap(h,u),h.swap(r.neg(),d),h.swap(h.neg(),i),h}_fixedMul(e,t){J(e instanceof l),J(t instanceof f),J(e.pre&&e.pre.windows);const{width:r,bits:i,points:s}=e._getWindows(0,0),n=1<<r,d=(i+r-1)/r>>>0;let o=this.jpoint();for(let f=0;f<d;f++){const e=t.bits(f*r,r);o=o.add(s[f*n+e])}return t.isNeg()&&(o=o.neg()),o}_fixedNafMul(e,t){J(e instanceof l),J(t instanceof f),J(e.pre&&e.pre.doubles);const{step:r,points:i}=e._getDoubles(0,0),s=function(e,t,r,i){J(i>>>0===i);const f=O(e,t,r),s=Math.ceil(f.length/i),n=new Array(s);let d=0;for(let o=0;o<f.length;o+=i){let e=0;for(let t=o+i-1;t>=o;t--)e=(e<<1)+f[t];n[d++]=e}return J(d===s),n}(t,2,t.bitLength()+1,r),n=((1<<r+1)-(r%2===0?2:1))/3;let d=this.jpoint(),o=this.jpoint();for(let f=n;f>0;f--){for(let e=0;e<s.length;e++){const t=s[e];t===f?o=o.add(i[e]):t===-f&&(o=o.sub(i[e]))}d=d.add(o)}return d}_windowMul(e,t,r){J(e>>>0===e),J(t instanceof l),J(r instanceof f);const i=1<<e,s=(Math.max(r.bitLength(),this.n.bitLength())+e-1)/e>>>0,n=new Array(i),d=t.toJ();n[0]=this.jpoint(),n[1]=d;for(let f=2;f<i;f+=2)n[f+0]=n[f>>1].dbl(),n[f+1]=n[f].add(d);let o=this.jpoint();for(let f=s-1;f>=0;f--){const t=r.bits(f*e,e);f===s-1?o=n[t]:(o=o.dblp(e),o=o.add(n[t]))}return r.isNeg()&&(o=o.neg()),o}_slideMul(e,t,r){J(e>>>0===e),J(t instanceof l),J(r instanceof f);const i=1<<e-1,s=new Array(i),n=t.toJ();s[0]=n.dblp(e-1);for(let f=1;f<i;f++)s[f]=s[f-1].add(n);let d=r.bitLength(),o=this.jpoint();for(;d>=e;){const t=d-e,f=r.bits(t,e);f<i?(o=o.dbl(),d-=1):(o=o.dblp(e),o=o.add(s[f&~i]),d=t)}if(d>0){const e=r.bits(0,d);for(;d--;)o=o.dbl(),e>>d&1&&(o=o.add(t))}return r.isNeg()&&(o=o.neg()),o}_wnafMul(e,t,r){J(t instanceof l),J(r instanceof f);const{width:i,points:s}=t._safeNAF(e),n=O(r,i,r.bitLength()+1);let d=this.jpoint();for(let f=n.length-1;f>=0;f--){const e=n[f];f!==n.length-1&&(d=d.dbl()),e>0?d=d.add(s[e-1>>1]):e<0&&(d=d.sub(s[-e-1>>1]))}return d}_wnafMulAdd(e,t,r){J(e>>>0===e),J(Array.isArray(t)),J(Array.isArray(r)),J(t.length===r.length);const i=t.length,s=new Array(i),n=new Array(i);let d=0;for(let a=0;a<i;a++){const e=t[a],i=r[a];if(J(e instanceof l),J(i instanceof f),a>0&&e.type!==t[a-1].type)throw new Error("Cannot mix points.");s[a]=null,n[a]=null,d=Math.max(d,i.bitLength()+1)}let o=null,h=null,u=0;for(let f=0;f<i;f++){const e=t[f],i=r[f],c=e._getNAF(0);c?(s[u]=c.points,n[u]=O(i,c.width,d),u+=1):o?(s[u]=o._getJNAF(e),n[u]=E(h,i,d),o=null,h=null,u+=1):(o=e,h=i)}if(o){const t=o._safeNAF(e);s[u]=t.points,n[u]=O(h,t.width,d),u+=1}let c=this.jpoint();for(let f=d-1;f>=0;f--){f!==d-1&&(c=c.dbl());for(let e=0;e<u;e++){const t=n[e][f];t>0?c=c.add(s[e][t-1>>1]):t<0&&(c=c.sub(s[e][-t-1>>1]))}}return c}_endoWnafMulAdd(e,t){throw new Error("Not implemented.")}_scale(e,t){switch(J(e instanceof c),J(e.p.eq(this.p)),e.type){case"short":return this._scaleShort(e,t);case"mont":return this._scaleMont(e,t);case"edwards":return this._scaleEdwards(e,t);default:throw new Error("Not implemented.")}}_scaleShort(e,t){throw new Error("Not implemented.")}_scaleMont(e,t){throw new Error("Not implemented.")}_scaleEdwards(e,t){throw new Error("Not implemented.")}isElliptic(){throw new Error("Not implemented.")}jinv(){throw new Error("Not implemented.")}isComplete(){return!1}precompute(e){return J(!this.g.isInfinity(),"Must have base point."),J(!this.n.isZero(),"Must have order."),this.g.precompute(this.n.bitLength(),e),this}scalar(e,t,r){const i=new f(e,t,r);return J(!i.red),this.n.isZero()?i:i.imod(this.n)}field(e,t,r){const i=f.cast(e,t,r);return i.red?i.forceRed(this.red):i.toRed(this.red)}point(e,t){throw new Error("Not implemented.")}jpoint(e,t,r){throw new Error("Not implemented.")}xpoint(e,t){throw new Error("Not implemented.")}cpoint(e,t,r,i){if(J(e instanceof f),J(t instanceof f),J(r instanceof f),J(i instanceof f),t.isZero()||i.isZero())return this.point();const s=t.redMul(i).redInvert(),n=e.redMul(i).redMul(s),d=r.redMul(t).redMul(s);return this.point(n,d)}solveX2(e){throw new Error("Not implemented.")}solveX(e){return this.solveX2(e).redSqrt()}solveY2(e){throw new Error("Not implemented.")}solveY(e){return this.solveY2(e).redSqrt()}validate(e){throw new Error("Not implemented.")}pointFromX(e,t){throw new Error("Not implemented.")}pointFromY(e,t){throw new Error("Not implemented.")}isIsomorphic(e){throw new Error("Not implemented.")}isIsogenous(e){throw new Error("Not implemented.")}pointFromShort(e){throw new Error("Not implemented.")}pointFromMont(e,t){throw new Error("Not implemented.")}pointFromEdwards(e){throw new Error("Not implemented.")}pointFromUniform(e){throw new Error("Not implemented.")}pointToUniform(e){throw new Error("Not implemented.")}pointFromHash(t,r=!1){if(J(e.isBuffer(t)),J("boolean"===typeof r),t.length!==2*this.fieldSize)throw new Error("Invalid hash size.");const i=t.slice(0,this.fieldSize),f=t.slice(this.fieldSize),s=this.decodeUniform(i),n=this.decodeUniform(f),d=this.pointFromUniform(s),o=this.pointFromUniform(n),h=d.uadd(o);return r?h.mulH():h}pointToHash(t,r,i){J(t instanceof this.Point),J(r>>>0===r);const f=r%this.torsion.length,s=t.add(this.torsion[f]);for(;;){const t=this.randomField(i),r=this.pointFromUniform(t);if(r.neg().eq(r))continue;const f=s.usub(r),d=Z(i);let o;try{o=this.pointToUniform(f,15&d)}catch(n){if("Invalid point."===n.message)continue;throw n}const h=this.encodeUniform(t,d>>>8),u=this.encodeUniform(o,d>>>16);return e.concat([h,u])}}randomScalar(e){const t=this.n.isZero()?this.p:this.n;return f.random(e,1,t)}randomField(e){return f.random(e,1,this.p).toRed(this.red)}randomPoint(e){let t;for(;;){const i=this.randomField(e),f=0!==(1&Z(e));try{t=this.pointFromX(i,f)}catch(r){continue}return J(t.validate()),t.mulH()}}mulAll(e,t){return this.jmulAll(e,t)}mulAllSimple(e,t){return this.jmulAllSimple(e,t)}jmulAll(e,t){return J(Array.isArray(e)),J(0===e.length||e[0]instanceof l),this.endo&&e.length>0&&e[0].type===s?this._endoWnafMulAdd(e,t):this._wnafMulAdd(5,e,t)}jmulAllSimple(e,t){return this._simpleMulAdd(e,t)}mulH(e){return J(e instanceof f),this.imulH(e.clone())}imulH(e){J(e instanceof f),J(!e.red);const t=this.h.word(0);if(0===(t&t-1)){const t=this.h.bitLength();return e.iushln(t-1).imod(this.n)}return e.imuln(t).imod(this.n)}clamp(t){J(e.isBuffer(t)),J(t.length===this.scalarSize),J(this.scalarSize<=this.fieldSize);let r=7&this.fieldBits||8,i=0,f=this.scalarSize-1;return"be"===this.endian&&([i,f]=[f,i]),this.scalarSize<this.fieldSize&&(r=8),t[i]&=255&-this.h.word(0),t[f]&=(1<<r)-1,t[f]|=1<<r-1,t}splitHash(t){J(e.isBuffer(t)),J(t.length===2*this.adjustedSize),J(this.scalarSize<=this.adjustedSize);let r=0;"be"===this.endian&&(r=this.adjustedSize-this.scalarSize);const i=t.slice(r,r+this.scalarSize),f=t.slice(this.adjustedSize);return this.clamp(i),[i,f]}encodeField(e){return J(e instanceof f),J(!e.red),e.encode(this.endian,this.fieldSize)}decodeField(t){if(J(e.isBuffer(t)),t.length!==this.fieldSize)throw new Error("Invalid field element size.");return f.decode(t,this.endian)}encodeAdjusted(e){return J(e instanceof f),J(!e.red),e.encode(this.endian,this.adjustedSize)}decodeAdjusted(t){if(J(e.isBuffer(t)),t.length!==this.adjustedSize)throw new Error("Invalid field element size.");return f.decode(t,this.endian)}encodeScalar(e){return J(e instanceof f),J(!e.red),e.encode(this.endian,this.scalarSize)}decodeScalar(t){if(J(e.isBuffer(t)),t.length!==this.scalarSize)throw new Error("Invalid scalar size.");return f.decode(t,this.endian)}encodeClamped(e){return this.clamp(this.encodeScalar(e))}decodeClamped(t){if(J(e.isBuffer(t)),t.length!==this.scalarSize)throw new Error("Invalid scalar size.");const r=this.clamp(e.from(t));return f.decode(r,this.endian)}encodeUniform(e,t){J(e instanceof f),J(t>>>0===t);const r="le"===this.endian?this.fieldSize-1:0,i=e.fromRed().encode(this.endian,this.fieldSize);return i[r]|=t&~this.mask&255,i}decodeUniform(t){if(J(e.isBuffer(t)),t.length!==this.fieldSize)throw new Error("Invalid field size.");const r=f.decode(t,this.endian);return r.iumaskn(this.fieldBits),r.toRed(this.red)}encodePoint(e,t){return J(e instanceof l),e.encode(t)}decodePoint(e){throw new Error("Not implemented.")}encodeX(e){throw new Error("Not implemented.")}decodeX(e){throw new Error("Not implemented.")}decodeEven(e){throw new Error("Not implemented.")}decodeSquare(e){throw new Error("Not implemented.")}toShort(){throw new Error("Not implemented.")}toMont(e){throw new Error("Not implemented.")}toEdwards(e){throw new Error("Not implemented.")}pointToJSON(e,t){return J(e instanceof l),e.toJSON(t)}pointFromJSON(e){throw new Error("Not implemented.")}toJSON(e){let t,r,i,f,s;return"edwards"===this.type&&(t=this.prefix?this.prefix.toString():null,r=this.context),this.n.isZero()||(i=this.n.toJSON()),this.z.isZero()||(f=this.z.fromRed(),this.z.redIsHigh()&&f.isub(this.p),f=f.toString(16)),this.endo&&(s=this.endo.toJSON()),{id:this.id,ossl:this.ossl,type:this.type,endian:this.endian,hash:this.hash,prefix:t,context:r,prime:this.prime,p:this.p.toJSON(),a:void 0,b:void 0,d:void 0,n:i,h:this.h.toString(16),s:void 0,z:f,c:void 0,g:this.g.toJSON(e),endo:s}}static fromJSON(e){return new this(e)}}class l{constructor(e,t){J(e instanceof c),J(t>>>0===t),this.curve=e,this.type=t,this.pre=null}_init(){throw new Error("Not implemented.")}_getNAF(e){if(J(e>>>0===e),this.pre&&this.pre.naf)return this.pre.naf;if(0===e)return null;const t=1<<e-2,r=new Array(t),i=1===t?null:this.dbl();r[0]=this;for(let f=1;f<t;f++)r[f]=r[f-1].add(i);return new y(e,r)}_safeNAF(e){return this._getNAF(e)}_getWindows(e,t){if(J(e>>>0===e),J(t>>>0===t),this.pre&&this.pre.windows)return this.pre.windows;if(0===e)return null;const r=1<<e,i=(t+e-1)/e>>>0,f=new Array(i*r);let s=this.toP();for(let n=0;n<i;n++){f[n*r]=this.curve.point();for(let e=1;e<r;e++)f[n*r+e]=f[n*r+e-1].add(s);s=s.dblp(e)}return new g(e,t,f)}_getDoubles(e,t){if(J(e>>>0===e),J(t>>>0===t),this.pre&&this.pre.doubles)return this.pre.doubles;if(0===e)return null;const r=Math.ceil(t/e)+1,i=new Array(r);let f=this,s=0;i[s++]=f;for(let n=0;n<t;n+=e){for(let t=0;t<e;t++)f=f.dbl();i[s++]=f}return J(s===r),new z(e,i)}_getBeta(){return null}_getBlinding(e){if(this.pre&&this.pre.blinding)return this.pre.blinding;if(!e)return null;if(this.curve.n.isZero())return null;const t=this.curve.randomScalar(e),r=this.mul(t);return new x(t,r)}_hasWindows(e){if(J(e instanceof f),!this.pre||!this.pre.windows)return!1;const{bits:t}=this.pre.windows;return t>=e.bitLength()}_hasDoubles(e){if(J(e instanceof f),!this.pre||!this.pre.doubles)return!1;const{step:t,points:r}=this.pre.doubles,i=e.bitLength()+1;return r.length>=Math.ceil(i/t)+1}_getJNAF(e){return J(e instanceof l),J(e.type===this.type),[this,this.add(e),this.sub(e),e]}_blind(e,t){if(J(e instanceof f),J(!e.red),this.pre&&this.pre.blinding){const{blind:t,unblind:r}=this.pre.blinding;return[this,e.sub(t),r]}if(!t)return[this,e,null];if(this.pre){if(this.curve.n.isZero())return[this,e,null];return[this,this.curve.randomScalar(t).mul(this.curve.n).iadd(e),null]}return[this.randomize(t),e,null]}clone(){throw new Error("Not implemented.")}swap(e,t){throw new Error("Not implemented.")}precompute(e,t){return J(e>>>0===e),this.pre||(this.pre=new v),this.pre.naf||(this.pre.naf=this._getNAF(9)),this.pre.doubles||(this.pre.doubles=this._getDoubles(4,e+1)),this.pre.beta||(this.pre.beta=this._getBeta()),this.pre.blinding||(this.pre.blinding=this._getBlinding(t)),this}validate(){return this.curve.validate(this)}normalize(){return this}scale(e){throw new Error("Not implemented.")}randomize(e){const t=this.curve.randomField(e);return this.scale(t)}neg(){throw new Error("Not implemented.")}add(e){throw new Error("Not implemented.")}sub(e){return J(e instanceof l),this.add(e.neg())}dbl(){throw new Error("Not implemented.")}dblp(e){J(e>>>0===e);let t=this;for(let r=0;r<e;r++)t=t.dbl();return t}uadd(e){throw new Error("Not implemented.")}usub(e){return J(e instanceof l),this.uadd(e.neg())}udbl(){throw new Error("Not implemented.")}zaddu(e){throw new Error("Not implemented.")}zaddc(e){throw new Error("Not implemented.")}zdblu(){throw new Error("Not implemented.")}diffAdd(e,t){throw new Error("Not implemented.")}diffAddDbl(e,t){throw new Error("Not implemented.")}recover(){throw new Error("Not implemented.")}getX(){throw new Error("Not implemented.")}getY(){throw new Error("Not implemented.")}eq(e){throw new Error("Not implemented.")}cmp(e){throw new Error("Not implemented.")}isInfinity(){throw new Error("Not implemented.")}isOrder2(){throw new Error("Not implemented.")}isOdd(){throw new Error("Not implemented.")}isEven(){throw new Error("Not implemented.")}isSquare(){throw new Error("Not implemented.")}eqX(e){throw new Error("Not implemented.")}eqR(e){throw new Error("Not implemented.")}isSmall(){return!this.isInfinity()&&this.jmulH().isInfinity()}hasTorsion(){return!this.isInfinity()&&!this.jmul(this.curve.n).isInfinity()}order(){const{h:e,n:t}=this.curve;let r=this.toJ(),i=new f(1);for(;!r.isInfinity();){if(i.iaddn(1),i.cmp(e)>0){i=t.clone();break}r=r.add(this)}return i}mul(e){return this.jmul(e)}muln(e){return this.jmuln(e)}mulSimple(e){return this.jmulSimple(e)}mulBlind(e,t){return this.jmulBlind(e,t)}mulConst(e,t){return this.jmulConst(e,t)}mulAdd(e,t,r){return this.jmulAdd(e,t,r)}mulAddSimple(e,t,r){return this.jmulAddSimple(e,t,r)}mulH(){return this.jmulH()}div(e){return this.jdiv(e)}divn(e){return this.jdivn(e)}divH(){return this.jdivH()}jmul(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo&&this.type===s?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(5,this,e)}jmuln(e){return J((0|e)===e),this.jmulSimple(new f(e))}jmulSimple(e){return this.curve._simpleMul(this,e)}jmulBlind(e,t=null){const[r,i,f]=this._blind(e,t),s=r.jmul(i);return f?s.add(f):s}jmulConst(e,t=null){const[r,i,f]=this._blind(e,t),s=this.curve._constMul(r,i,t);return f?s.uadd(f):s}jmulAdd(e,t,r){return this.curve.endo&&this.type===s?this.curve._endoWnafMulAdd([this,t],[e,r]):this.curve._wnafMulAdd(5,[this,t],[e,r])}jmulAddSimple(e,t,r){return this.curve._simpleMulAdd([this,t],[e,r])}jmulH(){const e=this.curve.h.word(0);if(0===(e&e-1)){const e=this.curve.h.bitLength();return this.toJ().dblp(e-1)}return this.jmulSimple(this.curve.h)}jdiv(e){return J(e instanceof f),J(!e.red),this.jmul(e.invert(this.curve.n))}jdivn(e){return J(!this.curve.n.isZero()),0===this.curve.h.cmpn(e)?this.jdivH():this.jdiv(new f(e))}jdivH(){return this.curve.n.isZero()||0===this.curve.h.cmpn(1)?this.toJ():(null===this.curve.hi&&(this.curve.hi=this.curve.h.invert(this.curve.n)),this.jmul(this.curve.hi))}ladder(e){throw new Error("Not implemented.")}ladderSimple(e){throw new Error("Not implemented.")}ladderBlind(e,t){throw new Error("Not implemented.")}ladderConst(e,t){throw new Error("Not implemented.")}toP(){return this.normalize()}toJ(){return this}toX(){return this}key(){if(this.isInfinity())return this.curve.uid+":oo";this.normalize();const e=this.getX().toString(16),t=this.getY().toString(16);return`${this.curve.uid}:${e},${t}`}encode(e){throw new Error("Not implemented.")}static decode(e,t){throw new Error("Not implemented.")}encodeX(){throw new Error("Not implemented.")}static decodeX(e,t){throw new Error("Not implemented.")}static decodeEven(e,t){throw new Error("Not implemented.")}static decodeSquare(e,t){throw new Error("Not implemented.")}toJSON(e){throw new Error("Not implemented.")}static fromJSON(e,t){throw new Error("Not implemented.")}[i](){return"<Point>"}}class a extends c{constructor(e){super(b,"short",e),this.a=f.fromJSON(e.a).toRed(this.red),this.b=f.fromJSON(e.b).toRed(this.red),this.c=f.fromJSON(e.c||"0").toRed(this.red),this.ai=this.a.isZero()?this.zero:this.a.redInvert(),this.zi=this.z.isZero()?this.zero:this.z.redInvert(),this.zeroA=this.a.isZero(),this.threeA=this.a.eq(this.three.redNeg()),this.redN=this.n.toRed(this.red),this.pmodn=this.p.clone(),this.highOrder=this.n.cmp(this.p)>=0,this.smallGap=!1,this._finalize(e)}_finalize(e){return super._finalize(e),null!=e.endo?this.endo=A.fromJSON(this,e.endo):this.endo=this._getEndomorphism(),this.n.isZero()||(this.pmodn=this.p.mod(this.n),this.smallGap=this.p.div(this.n).cmpn(1)<=0),this}static _isomorphism(e,t,r,i){if(J(e instanceof f),J(t instanceof f),J(r instanceof f),J(null==i||"boolean"===typeof i),J(!e.isZero()||!t.isZero()),r.isZero())throw new Error("Invalid coefficient.");if(e.isZero()){const i=r;return J(1===F(i.redDiv(t)).redJacobi()),[e.clone(),i.clone()]}if(t.isZero()){const i=r,f=i.redDiv(e).redSqrt();if(1!==f.redJacobi()&&f.redINeg(),1!==f.redJacobi())throw new Error("Invalid `a` coefficient.");return[i.clone(),t.clone()]}const s=r,n=s.redDiv(e),d=n.redSqrt();if(null!=i?d.redIsOdd()!==i&&d.redINeg():1!==d.redJacobi()&&d.redINeg(),1!==d.redJacobi())throw new Error("Invalid `a` coefficient.");const o=n.redMul(d),h=e.redMul(n),u=t.redMul(o);return J(h.eq(s)),[h,u]}_short(e,t){return a._isomorphism(this.a,this.b,e,t)}_mont(e,t){const[r,i]=this._findRS(t),f=i.redInvert(),s=r.redMuln(3).redMul(f);return null!=e?m._isomorphism(s,f,e):[s,f]}_edwards(e,t){const[r,i]=this._findRS(t),f=r.redMuln(3),s=i.redMuln(2),n=f.redAdd(s),d=f.redSub(s);return null!=e?w._isomorphism(n,d,e):[n,d]}_findRS(e){J(null==e||"boolean"===typeof e),J(this.h.word(0)>=4),J(!this.n.isZero());const t=this.one.redNeg();let r;for(;;){t.redIAdd(this.one);try{r=this.pointFromX(t.clone())}catch(s){continue}if(r=r.mul(this.n),!r.isInfinity()&&r.y.isZero())break}const i=r.x,f=i.redSqr().redMuln(3).redIAdd(this.a).redSqrt();return null!=e&&f.redIsOdd()!==e&&f.redINeg(),[i,f]}_scale0(e,t){if(J(this.a.isZero()===e.isZero()),J(this.b.isZero()===t.isZero()),this.a.isZero()){const e=this.b.redDiv(this.field(t)),r=F(e),i=r.redSqrt(),f=r.redMul(i);return J(f.redSqr().eq(e)),J(!i.isZero()),[r,f]}if(this.b.isZero()){const t=this.a.redDiv(this.field(e)),r=t.redSqrt();1!==r.redJacobi()&&r.redINeg();const i=r.redSqrt(),f=r.redMul(i);return J(f.redMul(i).eq(t)),J(!i.isZero()),[r,f]}const r=this.a.redDiv(this.field(e)),i=this.b.redDiv(this.field(t)),f=r.redSqrt();r.redMul(f).eq(i)||f.redINeg(),J(r.redMul(f).eq(i));const s=f.redSqrt(),n=f.redMul(s);return J(!s.isZero()),[f,n]}_scale1(e,t){const r=this.g.x.redDiv(this.field(e)),i=this.g.y.redDiv(this.field(t)),f=r.redSqrt();return r.redMul(f).eq(i)||f.redINeg(),J(r.redMul(f).eq(i)),J(!f.isZero()),[r,i]}_scaleShort(e){return J(e instanceof a),this.g.isInfinity()||e.g.isInfinity()?this._scale0(e.a,e.b):this._scale1(e.g.x,e.g.y)}_scaleMont(e){if(J(e instanceof m),this.g.isInfinity()||e.g.isInfinity()){const[t,r]=e._short();return this._scale0(t,r)}const{x:t,y:r}=e.g,i=t.redAdd(e.a3).redMul(e.bi),f=r.redMul(e.bi);return this._scale1(i,f)}_scaleEdwards(e){if(J(e instanceof w),this.g.isInfinity()||e.g.isInfinity()){const[t,r]=e._short();return this._scale0(t,r)}const{x:t,y:r,z:i}=e.g,f=e.a.redMuln(5),s=e.d.redMuln(5),n=e.d.redSub(e.a),d=s.redSub(e.a),o=e.d.redSub(f),h=r.redAdd(i),u=r.redSub(i),c=d.redMul(r).redIAdd(o.redMul(i)),l=u.redMuln(12),a=n.redMul(h).redMul(i),b=u.redMul(t).redIMuln(4),p=l.redMul(b).redInvert(),m=c.redMul(b).redMul(p),S=a.redMul(l).redMul(p);return this._scale1(m,S)}_getEndomorphism(e=0){if(this.n.isZero()||this.g.isInfinity())return null;if(!this.zeroA||1!==this.p.modrn(3)||1!==this.n.modrn(3))return null;const[t,r]=this._getEndoRoots(this.p),i=[t,r][1&e].toRed(this.red),[f,s]=this._getEndoRoots(this.n),n=this.point(this.g.x.redMul(i),this.g.y);let d;this.g.mul(f).eq(n)?d=f:(J(this.g.mul(s).eq(n)),d=s);const o=this._getEndoBasis(d),h=this._getEndoPrecomp(o);return new A(i,d,o,h)}_getEndoRoots(e){const t=e===this.p?this.red:f.mont(e),r=new f(2).toRed(t),i=new f(3).toRed(t),s=r.redInvert(),n=i.redNeg().redSqrt().redMul(s),d=n.redNeg();return[n.redSub(s).fromRed(),d.redSub(s).fromRed()].sort(f.cmp)}_getEndoBasis(e){const[t,r,i,f,s,n]=this._egcdSqrt(e),d=i,o=f.neg(),h=t.sqr().iadd(r.sqr()),u=s.sqr().iadd(n.sqr());let c,l;return h.cmp(u)<=0?(c=t,l=r.neg()):(c=s,l=n.neg()),[new N(d,o),new N(c,l)]}_egcdSqrt(e){J(e instanceof f),J(!e.red),J(e.sign()>0),J(this.n.sign()>0);const t=this.n.ushrn(this.n.bitLength()>>>1);let r,i,s,n,d,o=e,h=this.n.clone(),u=new f(1),c=new f(0),l=new f(0),a=new f(1),b=0,p=0;for(;!o.isZero()&&b<2;){const e=h.quo(o),f=h.sub(e.mul(o)),m=l.sub(e.mul(u)),S=a.sub(e.mul(c));0===p&&f.cmp(t)<0&&(r=d,i=u,s=f,n=m,p=1),d=f,h=o,o=f,l=u,u=m,a=c,c=S,b+=p}J(0!==p,"Could not find r < sqrt(n).");return[r,i,s,n,l,u]}_getEndoPrecomp(e){J(Array.isArray(e)),J(2===e.length),J(e[0]instanceof N),J(e[1]instanceof N);const[t,r]=e,i=t.a.mul(r.b).isub(t.b.mul(r.a)),s=i.bitLength()+16,n=f.shift(1,s),d=n.mul(r.b).divRound(i),o=n.mul(t.b).divRound(i);return J(i.eq(this.n)),[d,o]}_endoSplit(e){J(e instanceof f),J(!e.red),J(!this.n.isZero());const[t,r]=this.endo.basis,i=r.b.mul(e).divRound(this.n),s=t.b.neg().mul(e).divRound(this.n),n=i.mul(t.a),d=s.mul(r.a),o=i.ineg().mul(t.b),h=s.mul(r.b);return[e.sub(n).isub(d),o.isub(h)]}_endoBeta(e){return J(e instanceof b),[e,e._getBeta()]}_endoWnafMulAdd(e,t){J(Array.isArray(e)),J(Array.isArray(t)),J(e.length===t.length),J(null!=this.endo);const r=e.length,i=new Array(2*r),f=new Array(2*r);for(let s=0;s<r;s++){const[r,n]=this._endoBeta(e[s]),[d,o]=this._endoSplit(t[s]);i[2*s+0]=r,f[2*s+0]=d,i[2*s+1]=n,f[2*s+1]=o}return this._wnafMulAdd(5,i,f)}_icart(e){const{a:t,b:r,i3:i,one:f}=this,s=i.redSqr().redMul(i),n=this.p.ushln(1).isubn(1).idivn(3),d=e.clone();d.cinject(f,d.czero());const o=d.redSqr(),h=o.redSqr(),u=h.redMul(o),c=d.redMuln(6).redFermat(),l=t.redMuln(3).redISub(h).redMul(c),a=l.redSqr(),b=u.redMul(s),p=o.redMul(i),m=a.redISub(r).redISub(b).redPow(n).redIAdd(p),S=d.redMul(m).redIAdd(l);return this.point(m,S)}_sswu(e){const{b:t,z:r,ai:i,zi:f,one:s}=this,n=this.p.subn(2),d=r.redSqr(),o=t.redNeg().redMul(i),h=t.redMul(f).redMul(i),u=e.redSqr(),c=u.redSqr(),l=d.redMul(c).redIAdd(r.redMul(u)).redPow(n),a=o.redMul(s.redAdd(l));a.cinject(h,l.czero());const b=r.redMul(u).redMul(a),p=this.solveY2(a),m=this.solveY2(b),S=0|p.redIsSquare(),M=a.cinject(b,1^S),w=p.cinject(m,1^S).redSqrt();return w.cinject(w.redNeg(),w.redIsOdd()^e.redIsOdd()),this.point(M,w)}_sswui(e,t){const{a:r,b:i,z:f}=this,{x:s,y:n}=e,d=3&t,o=r.redSqr().redMul(s.redSqr()),h=r.redMul(i).redMul(s).redIMuln(2),u=i.redSqr().redMuln(3),c=r.redMul(s).redIAdd(i),[l,a]=j(o.redISub(h).redISub(u)),b=c.redSub(a).redINeg(),p=c.redAdd(a).redINeg(),m=c.redMul(f).redIMuln(2),S=i.redMul(f).redIMuln(2);b.cinject(p,1&d),m.cinject(S,d>>>1);const[M,w]=P(b,m);if(w.cinject(w.redNeg(),w.redIsOdd()^n.redIsOdd()),!(l&M))throw new Error("Invalid point.");return w}_svdwf(e){const{c:t,z:r,zi:i,i2:f,i3:s}=this,n=this.p.subn(2),d=this.solveY2(r),o=s.redMul(i.redSqr()),h=e.redSqr(),u=h.redSqr(),c=h.redAdd(d),l=h.redMul(c).redPow(n),a=u.redMul(l).redMul(t),b=c.redSqr().redMul(c),p=t.redSub(r).redMul(f).redISub(a),m=a.redSub(t.redAdd(r).redMul(f)),S=r.redSub(b.redMul(l).redMul(o)),M=this.solveY2(p),w=this.solveY2(m),I=this.solveY2(S),v=0|M.redIsSquare(),y=0|w.redIsSquare();return p.cinject(m,(1^v)&y),M.cinject(w,(1^v)&y),p.cinject(S,(1^v)&(1^y)),M.cinject(I,(1^v)&(1^y)),[p,M]}_svdw(e){const[t,r]=this._svdwf(e),i=r.redSqrt();return i.cinject(i.redNeg(),i.redIsOdd()^e.redIsOdd()),this.point(t,i)}_svdwi(e,t){const{b:r,c:i,z:f,two:s}=this,{x:n,y:d}=e,o=3&t,h=f.redSqr(),u=h.redMul(f),c=h.redSqr(),l=u.redAdd(r),a=l.redMuln(2),b=n.redSqr(),p=n.redMuln(2).redIAdd(f),m=n.redMul(h),S=i.redSub(p),M=i.redAdd(p),w=b.redMul(h).redIAdd(c).redIMuln(9),I=n.redMul(u).redIMuln(18),v=l.redMul(n.redSub(f)).redIMuln(12),[y,g]=j(w.redISub(I).redIAdd(v)),z=o-2>>>31|y,x=g.redMul(f),A=u.redISub(m).redIMuln(3).redISub(a),N=l.redMul(S),q=l.redMul(M),_=A.redAdd(x),O=A.redSub(x),E=s.clone();N.cinject(q,(1^o)-1>>>31),N.cinject(_,(2^o)-1>>>31),N.cinject(O,(3^o)-1>>>31),E.cinject(M,(0^o)-1>>>31),E.cinject(S,(1^o)-1>>>31);const[J,R]=P(N,E),[F]=this._svdwf(R),Z=F.ceq(n);if(R.cinject(R.redNeg(),R.redIsOdd()^d.redIsOdd()),!(z&J&Z))throw new Error("Invalid point.");return R}isElliptic(){const{a:e,b:t}=this,r=e.redSqr().redMul(e);return!t.redSqr().redMuln(27).redIAdd(r.redMuln(4)).isZero()}jinv(){const{a:e,b:t}=this,r=e.redSqr().redMul(e),i=t.redSqr(),f=r.redMuln(4),s=f.redMuln(1728),n=i.redMuln(27).redIAdd(f);if(n.isZero())throw new Error("Curve is not elliptic.");return s.redDiv(n).fromRed()}point(e,t,r=0){return new b(this,e,t,r)}jpoint(e,t,r){return new p(this,e,t,r)}solveX(e){if(J(e instanceof f),!this.a.isZero())throw new Error("Not implemented.");return R(e.redSqr().redSub(this.b))}solveY2(e){J(e instanceof f);const t=e.redSqr().redMul(e).redIAdd(this.b);return this.zeroA||(this.threeA?t.redIAdd(e.redMuln(-3)):t.redIAdd(this.a.redMul(e))),t}validate(e){if(J(e instanceof b),e.inf)return!0;const{x:t,y:r}=e,i=this.solveY2(t);return r.redSqr().eq(i)}pointFromX(e,t=null){J(e instanceof f),J(null==t||"boolean"===typeof t),e.red||(e=e.toRed(this.red));const r=this.solveY(e);if(null!=t){if(this.h.cmpn(1)>0&&r.isZero()&&t)throw new Error("Invalid point.");r.redIsOdd()!==t&&r.redINeg()}return this.point(e,r)}pointFromY(e,t=0){J(e instanceof f),J(t>>>0===t),e.red||(e=e.toRed(this.red));const r=this.solveX(e);if(t>=r.length)throw new Error("Invalid X coordinate index.");const i=r[t];return this.point(i,e)}isIsomorphic(e){if(J(e instanceof c),!e.p.eq(this.p))return!1;let t,r;try{[t,r]=this._scale(e)}catch(i){return!1}if("short"===e.type){const i=this.field(e.a).redMul(t.redSqr()),f=this.field(e.b).redMul(r.redSqr());return this.a.eq(i)&&this.b.eq(f)}if("mont"===e.type){const{a3:r,bi:i}=e,f=this.field(r.redMul(i)).redMul(t);return this.solveY2(f).isZero()}if("edwards"===e.type){const r=this.field(e.ad6).redMul(t);return this.solveY2(r).isZero()}return!1}isIsogenous(e){return J(e instanceof c),!1}pointFromShort(e){if(J(e instanceof b),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();const[t,r]=this._scale(e.curve),i=this.field(e.x),f=this.field(e.y),s=i.redMul(t),n=f.redMul(r);return this.point(s,n)}throw new Error("Not implemented.")}pointFromMont(e){if(J(e instanceof S),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();const{a3:t,bi:r}=e.curve,[i,f]=this._scale(e.curve),s=e.x.redAdd(t).redMul(r),n=e.y.redMul(r);return this.point(this.field(s).redMul(i),this.field(n).redMul(f))}throw new Error("Not implemented.")}pointFromEdwards(e){if(J(e instanceof I),this.isIsomorphic(e.curve)){const{a:t,d:r,ad6:i}=e.curve,[f,s]=this._scale(e.curve);if(e.isInfinity())return this.point();if(e.x.isZero()){const e=this.field(i).redMul(f);return this.point(e,this.zero)}const{x:n,y:d,z:o}=e,h=t.redMuln(5),u=r.redMuln(5),c=r.redSub(t),l=u.redSub(t),a=r.redSub(h),b=d.redAdd(o),p=d.redSub(o),m=l.redMul(d).redIAdd(a.redMul(o)),S=p.redMuln(12),M=c.redMul(b).redMul(o),w=p.redMul(n).redIMuln(4);return this.cpoint(this.field(m).redMul(f),this.field(S),this.field(M).redMul(s),this.field(w))}throw new Error("Not implemented.")}pointFromUniform(e){if(J(e instanceof f),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(!this.a.isZero())return this._sswu(e);if(!this.c.isZero())return this._svdw(e);throw new Error("Not implemented.")}pointToUniform(e,t){if(J(e instanceof b),J(t>>>0===t),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(e.isInfinity())throw new Error("Invalid point.");const r=(t>>>4&15)%this.torsion.length,i=e.add(this.torsion[r]);if(!this.a.isZero())return this._sswui(i,t);if(!this.c.isZero())return this._svdwi(i,t);throw new Error("Not implemented.")}mulAll(e,t){return super.mulAll(e,t).toP()}mulAllSimple(e,t){return super.mulAllSimple(e,t).toP()}decodePoint(e){return b.decode(this,e)}encodeX(e){return J(e instanceof l),e.encodeX()}decodeEven(e){return b.decodeEven(this,e)}decodeSquare(e){return b.decodeSquare(this,e)}toShort(e,t,r=null){const[i,f]=this._short(e,t),s=new a({red:this.red,prime:this.prime,p:this.p,a:i,b:f,n:this.n,h:this.h});if(null!=r){const[,e]=s._scale(this);e.redIsOdd()!==r&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromShort(this.g));for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromShort(this.torsion[n]);return s}toMont(e,t,r=null){const[i,f]=this._mont(e,t),s=new m({red:this.red,prime:this.prime,p:this.p,a:i,b:f,n:this.n,h:this.h});if(null!=r){const[,e]=this._scale(s);e.redIsOdd()!==r&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromShort(this.g));for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromShort(this.torsion[n]);return s}toEdwards(e,t,r=null){const[i,f]=this._edwards(e,t),s=new w({red:this.red,prime:this.prime,p:this.p,a:i,d:f,n:this.n,h:this.h});if(null!=r){const[,e]=this._scale(s);e.redIsOdd()!==r&&e.redINeg()}if(this.g.isInfinity()||(s.g=s.pointFromShort(this.g),s.g.normalize()),s.isComplete())for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromShort(this.torsion[n]),s.torsion[n].normalize();return s}pointFromJSON(e){return b.fromJSON(this,e)}toJSON(e){const t=super.toJSON(e);return t.a=this.a.fromRed().toJSON(),t.b=this.b.fromRed().toJSON(),this.c.isZero()||(t.c=this.c.fromRed().toJSON()),t}}class b extends l{constructor(e,t,r,i){J(e instanceof a),super(e,s),this.x=this.curve.zero,this.y=this.curve.zero,this.inf=1,null!=t&&this._init(t,r,i)}_init(e,t,r){J(e instanceof f),J(t instanceof f),this.x=e,this.y=t,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=0|r}_safeNAF(e){return J(e>>>0===e),this.pre&&this.pre.naf?this.pre.naf:e>1?this.toJ()._getNAF(e):this._getNAF(e)}_getBeta(){if(!this.curve.endo)return null;if(this.pre&&this.pre.beta)return this.pre.beta;const e=this.x.redMul(this.curve.endo.beta),t=this.curve.point(e,this.y);return this.pre&&(t.pre=this.pre.map(e=>{const t=e.x.redMul(this.curve.endo.beta);return this.curve.point(t,e.y)}),this.pre.beta=t),t}_getJNAF(e){if(J(e instanceof b),this.inf|e.inf)return super._getJNAF(e);const t=[this,null,null,e];return this.y.eq(e.y)?(t[1]=this.add(e),t[2]=this.toJ().sub(e)):this.y.eq(e.y.redNeg())?(t[1]=this.toJ().add(e),t[2]=this.sub(e)):(t[1]=this.toJ().add(e),t[2]=this.toJ().sub(e)),t}clone(){return this.curve.point(this.x.clone(),this.y.clone(),this.inf)}swap(e,t){J(e instanceof b);const r=1&(t>>31|-t>>31),i=this.inf,f=e.inf;return this.x.cswap(e.x,t),this.y.cswap(e.y,t),this.inf=i&(1^r)|f&r,e.inf=f&(1^r)|i&r,this}scale(e){return this.toJ().scale(e)}neg(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}add(e){if(J(e instanceof b),this.inf)return e;if(e.inf)return this;if(this.x.eq(e.x))return this.y.eq(e.y)?this.dbl():this.curve.point();if(this.y.eq(e.y)){const t=this.x.redNeg().redISub(e.x),r=this.y.redNeg();return this.curve.point(t,r)}const t=this.x.redSub(e.x),r=this.y.redSub(e.y).redDiv(t),i=r.redSqr().redISub(this.x).redISub(e.x),f=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,f)}dbl(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();const e=this.x.redSqr().redIMuln(3).redIAdd(this.curve.a),t=this.y.redMuln(2),r=e.redDiv(t),i=r.redSqr().redISub(this.x).redISub(this.x),f=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,f)}dblp(e){return this.toJ().dblp(e).toP()}uadd(e){J(e instanceof b);const t=this.y.redAdd(e.y),r=this.x.redAdd(e.x).redSqr(),i=this.x.redMul(e.x),f=r.redISub(i).redIAdd(this.curve.a),s=t.czero()&f.czero();t.cinject(this.x.redSub(e.x),s),f.cinject(this.y.redSub(e.y),s);const n=t.czero()&(1^(this.inf|e.inf));t.cinject(this.curve.one,t.czero());const d=f.redMul(t.redFermat()),o=d.redSqr().redISub(this.x).redISub(e.x),h=d.redMul(this.x.redSub(o)).redISub(this.y),u=n|this.inf&e.inf;return o.cinject(e.x,this.inf),h.cinject(e.y,this.inf),o.cinject(this.x,e.inf),h.cinject(this.y,e.inf),o.cinject(this.curve.zero,u),h.cinject(this.curve.zero,u),this.curve.point(o,h,u)}udbl(){return this.uadd(this)}recover(e,t,r,i){if(J(e instanceof f),J(t instanceof f),J(r instanceof f),J(i instanceof f),this.inf)return this.curve.jpoint();const s=t.redMul(i),n=s.redSqr(),d=n.redMul(s),o=this.x.redMul(s),h=e.redMul(i),u=r.redMul(t),c=this.curve.b.redMul(d).redIMuln(2),l=o.redMul(h).redIAdd(this.curve.a.redMul(n)),a=o.redAdd(h),b=o.redISub(h),p=c.redIAdd(l.redMul(a)),m=u.redMul(b.redSqr()),S=p.redISub(m),M=this.y.redMul(d).redIMuln(2),w=e.redMul(M),I=S.redMul(t),v=t.redMul(M),y=w.redMul(v),g=I.redMul(v.redSqr()),z=v;return this.curve.jpoint(y,g,z)}getX(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}getY(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}eq(e){return J(e instanceof b),this===e||(this.inf?0!==e.inf:!e.inf&&(this.x.eq(e.x)&&this.y.eq(e.y)))}cmp(e){return J(e instanceof b),this.inf&&!e.inf?-1:!this.inf&&e.inf?1:this.inf&&e.inf?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}isInfinity(){return 0!==this.inf}isOrder2(){return!this.inf&&this.y.isZero()}isOdd(){return!this.inf&&this.y.redIsOdd()}isEven(){return!this.inf&&this.y.redIsEven()}isSquare(){return!this.inf&&-1!==this.y.redJacobi()}eqX(e){return J(e instanceof f),J(!e.red),!this.inf&&this.getX().eq(e)}eqR(e){return J(e instanceof f),J(!e.red),J(!this.curve.n.isZero()),!this.inf&&this.getX().imod(this.curve.n).eq(e)}mul(e){return super.mul(e).toP()}muln(e){return super.muln(e).toP()}mulSimple(e){return super.mulSimple(e).toP()}mulBlind(e,t){return super.mulBlind(e,t).toP()}mulConst(e,t){return super.mulConst(e,t).toP()}mulAdd(e,t,r){return super.mulAdd(e,t,r).toP()}mulAddSimple(e,t,r){return super.mulAddSimple(e,t,r).toP()}mulH(){return super.mulH().toP()}div(e){return super.div(e).toP()}divn(e){return super.divn(e).toP()}divH(){return super.divH().toP()}toP(){return this}toJ(){return this.inf?this.curve.jpoint():this.curve.jpoint(this.x,this.y,this.curve.one)}encode(t){null==t&&(t=!0),J("boolean"===typeof t);const{fieldSize:r}=this.curve;if(this.inf)throw new Error("Invalid point.");if(t){const t=e.alloc(1+r),i=this.curve.encodeField(this.getX());return t[0]=2|this.y.redIsOdd(),i.copy(t,1),t}const i=e.alloc(1+2*r),f=this.curve.encodeField(this.getX()),s=this.curve.encodeField(this.getY());return i[0]=4,f.copy(i,1),s.copy(i,1+r),i}static decode(t,r){J(t instanceof a),J(e.isBuffer(r));const i=t.fieldSize;if(r.length<1+i)throw new Error("Not a point.");const f=r[0];switch(f){case 2:case 3:{if(r.length!==1+i)throw new Error("Invalid point size for compressed.");const e=t.decodeField(r.slice(1,1+i));if(e.cmp(t.p)>=0)throw new Error("Invalid point.");const s=t.pointFromX(e,3===f);return J(!s.isInfinity()),s}case 4:case 6:case 7:{if(r.length!==1+2*i)throw new Error("Invalid point size for uncompressed.");const e=t.decodeField(r.slice(1,1+i)),s=t.decodeField(r.slice(1+i,1+2*i));if(e.cmp(t.p)>=0||s.cmp(t.p)>=0)throw new Error("Invalid point.");if(4!==f&&f!==(6|s.isOdd()))throw new Error("Invalid hybrid encoding.");const n=t.point(e,s);if(!n.validate())throw new Error("Invalid point.");return J(!n.isInfinity()),n}default:throw new Error("Unknown point format.")}}encodeX(){return this.curve.encodeField(this.getX())}static decodeEven(e,t){J(e instanceof a);const r=e.decodeField(t);if(r.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromX(r,!1)}static decodeSquare(e,t){J(e instanceof a);const r=e.decodeField(t);if(r.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromX(r)}toJSON(e){if(this.inf)return[];const t=this.getX().toJSON(),r=this.getY().toJSON();return!0===e&&this.pre?[t,r,this.pre.toJSON()]:[t,r]}toPretty(){if(this.inf)return[];const e=2*this.curve.fieldSize;return[D(this.getX(),e),D(this.getY(),e)]}static fromJSON(e,t){if(J(e instanceof a),J(Array.isArray(t)),J(0===t.length||2===t.length||3===t.length),0===t.length)return e.point();const r=f.fromJSON(t[0]),i=f.fromJSON(t[1]),s=e.point(r,i);return t.length>2&&null!=t[2]&&(s.pre=v.fromJSON(s,t[2])),s}[i](){return this.inf?"<ShortPoint: Infinity>":"<ShortPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}}class p extends l{constructor(e,t,r,i){J(e instanceof a),super(e,n),this.x=this.curve.one,this.y=this.curve.one,this.z=this.curve.zero,this.zOne=0,null!=t&&this._init(t,r,i)}_init(e,t,r){J(e instanceof f),J(t instanceof f),J(null==r||r instanceof f),this.x=e,this.y=t,this.z=r||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=0|this.z.eq(this.curve.one)}clone(){return this.curve.jpoint(this.x.clone(),this.y.clone(),this.z.clone())}swap(e,t){J(e instanceof p);const r=1&(t>>31|-t>>31),i=this.zOne,f=e.zOne;return this.x.cswap(e.x,t),this.y.cswap(e.y,t),this.z.cswap(e.z,t),this.zOne=i&(1^r)|f&r,e.zOne=f&(1^r)|i&r,this}validate(){const{a:e,b:t}=this.curve;if(this.isInfinity())return!0;if(this.zOne)return this.curve.validate(this.toP());const r=this.y.redSqr(),i=this.x.redSqr().redMul(this.x),f=this.z.redSqr(),s=f.redSqr(),n=s.redMul(f),d=i.redIAdd(t.redMul(n));return this.curve.zeroA||(this.curve.threeA?d.redIAdd(s.redIMuln(-3).redMul(this.x)):d.redIAdd(e.redMul(s).redMul(this.x))),r.eq(d)}normalize(){if(this.zOne)return this;if(this.isInfinity())return this;const e=this.z.redInvert(),t=e.redSqr();return this.x=this.x.redMul(t),this.y=this.y.redMul(t).redMul(e),this.z=this.curve.one,this.zOne=1,this}scale(e){if(J(e instanceof f),this.isInfinity())return this.curve.jpoint();const t=e.redSqr(),r=this.x.redMul(t),i=this.y.redMul(t).redMul(e),s=this.z.redMul(e);return this.curve.jpoint(r,i,s)}neg(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)}add(e){return J(e instanceof l),e.type===s?this._mixedAdd(e):this._add(e)}_add(e){return J(e instanceof p),this.isInfinity()?e:e.isInfinity()?this:this.zOne&&e.zOne?this._addAA(e):this.zOne?e._addJA(this):e.zOne?this._addJA(e):this._addJJ(e)}_mixedAdd(e){return J(e instanceof b),this.isInfinity()?e.toJ():e.isInfinity()?this:this.zOne?this._addAA(e):this._addJA(e)}_addJJ(e){const t=this.z.redSqr(),r=e.z.redSqr(),i=this.x.redMul(r),f=e.x.redMul(t),s=this.y.redMul(e.z).redMul(r),n=e.y.redMul(this.z).redMul(t),d=f.redISub(i),o=n.redISub(s);if(d.isZero())return o.isZero()?this.dbl():this.curve.jpoint();const h=d.redSqr(),u=d.redMul(h),c=i.redMul(h),l=o.redSqr().redISub(u).redISub(c).redISub(c),a=o.redMul(c.redISub(l)).redISub(s.redMul(u)),b=this.z.redMul(e.z).redMul(d);return this.curve.jpoint(l,a,b)}_addJA(e){const t=this.z.redSqr(),r=e.x.redMul(t),i=e.y.redMul(this.z).redMul(t),f=r.redISub(this.x),s=i.redISub(this.y).redIMuln(2);if(f.isZero())return s.isZero()?this.dbl():this.curve.jpoint();const n=f.redMuln(2).redSqr(),d=f.redMul(n),o=this.x.redMul(n),h=s.redSqr().redISub(d).redISub(o).redISub(o),u=s.redMul(o.redISub(h)).redISub(this.y.redMul(d).redIMuln(2)),c=this.z.redMul(f).redIMuln(2);return this.curve.jpoint(h,u,c)}_addAA(e){const t=e.x.redSub(this.x),r=e.y.redSub(this.y).redIMuln(2);if(t.isZero())return r.isZero()?this.dbl():this.curve.jpoint();const i=t.redSqr().redIMuln(4),f=t.redMul(i),s=this.x.redMul(i),n=r.redSqr().redISub(f).redISub(s).redISub(s),d=r.redMul(s.redISub(n)).redISub(this.y.redMul(f).redIMuln(2)),o=t.redIMuln(2);return this.curve.jpoint(n,d,o)}dbl(){return this.isInfinity()?this:this.y.isZero()?this.curve.jpoint():this.zOne?this._dblA():this.curve.zeroA?this._dbl0():this.curve.threeA?this._dbl3():this._dblJ()}_dblJ(){const e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),i=this.x.redMul(t).redIMuln(4),f=e.redIMuln(3).redIAdd(this.curve.a.redMul(r.redSqr())),s=f.redSqr().redISub(i).redISub(i),n=s,d=f.redMul(i.redISub(s)).redISub(t.redSqr().redIMuln(8)),o=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(n,d,o)}_dblA(){const e=this.x.redSqr(),t=this.y.redSqr(),r=t.redSqr(),i=t.redIAdd(this.x).redSqr().redISub(e).redISub(r).redIMuln(2),f=e.redIMuln(3).redIAdd(this.curve.a),s=f.redSqr().redISub(i).redISub(i),n=s,d=f.redMul(i.redISub(s)).redISub(r.redIMuln(8)),o=this.y.redMuln(2);return this.curve.jpoint(n,d,o)}_dbl0(){const e=this.x.redSqr(),t=this.y.redSqr(),r=t.redSqr(),i=t.redIAdd(this.x).redSqr().redISub(e).redISub(r).redIMuln(2),f=e.redIMuln(3),s=f.redSqr().redISub(i).redISub(i),n=f.redMul(i.redISub(s)).redISub(r.redIMuln(8)),d=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(s,n,d)}_dbl3(){const e=this.z.redSqr(),t=this.y.redSqr(),r=this.x.redMul(t),i=this.x.redSub(e),f=this.x.redAdd(e),s=i.redMul(f).redIMuln(3),n=r.redIMuln(4),d=n.redMuln(2),o=t.redSqr().redIMuln(8),h=s.redSqr().redISub(d),u=this.y.redAdd(this.z).redSqr().redISub(t).redISub(e),c=s.redMul(n.redISub(h)).redISub(o);return this.curve.jpoint(h,c,u)}dblp(e){return J(e>>>0===e),this.curve.zeroA||this.curve.threeA?super.dblp(e):0===e||this.isInfinity()?this:this._dblp(e)}_dblp(e){const{a:t,i2:r}=this.curve;let i=this.x,f=this.z,s=this.y.redMuln(2),n=f.redPown(4);for(let d=0;d<e;d++){if(s.isZero())return this.curve.jpoint();const r=i.redSqr(),o=s.redSqr(),h=o.redSqr(),u=r.redIMuln(3).redIAdd(t.redMul(n)),c=i.redMul(o),l=u.redSqr().redISub(c).redISub(c),a=l,b=u.redMul(c.redISub(l)).redIMuln(2).redISub(h),p=s.redMul(f);d+1<e&&(n=n.redMul(h)),i=a,s=b,f=p}return this.curve.jpoint(i,s.redMul(r),f)}uadd(e){return J(e instanceof l),e.type===s?this._uadd(e.toJ()):this._uadd(e)}_uadd(e){J(e instanceof p);const{zero:t,one:r}=this.curve,i=this.z.redSqr(),f=e.z.redSqr(),s=this.x.redMul(f),n=e.x.redMul(i),d=this.y.redMul(f).redMul(e.z),o=e.y.redMul(i).redMul(this.z),h=this.z.redMul(e.z),u=s.redAdd(n),c=d.redAdd(o),l=u.redSqr().redISub(s.redMul(n));if(!this.curve.zeroA){const e=h.redPown(4);this.curve.threeA?l.redIAdd(e.redIMuln(-3)):l.redIAdd(this.curve.a.redMul(e))}const a=c.czero()&l.czero();c.cinject(s.redSub(n),a),l.cinject(d.redSub(o),a);const b=c.redSqr(),m=u.redMul(b),S=b.redSqr();S.cinject(t,a);const M=l.redSqr(),w=h.redMul(c),I=m.redMuln(3).redISub(M).redISub(M),v=M.redISub(m).redIMuln(4),y=l.redMul(I).redISub(S).redIMuln(4),g=w.redIMuln(2),z=this.z.czero(),x=e.z.czero(),A=g.czero()&(1^(z|x));return v.cinject(e.x,z),y.cinject(e.y,z),g.cinject(e.z,z),v.cinject(this.x,x),y.cinject(this.y,x),g.cinject(this.z,x),v.cinject(r,A),y.cinject(r,A),g.cinject(t,A),this.curve.jpoint(v,y,g)}udbl(){const e=this._udbl(),t=this.z.czero()|this.y.czero();return e.x.cinject(this.curve.one,t),e.y.cinject(this.curve.one,t),e.z.cinject(this.curve.zero,t),e}_udbl(){return this.curve.zeroA?this._dbl0():this.curve.threeA?this._dbl3():this._dblJ()}zaddu(e){J(e instanceof p);const t=this.x.redSub(e.x),r=this.y.redSub(e.y),i=t.redSqr(),f=this.x.redMul(i),s=e.x.redMul(i),n=f,d=r.redSqr().redISub(f).redISub(s),o=this.y.redMul(f.redSub(s)),h=r.redMul(n.redSub(d)).redISub(o),u=this.z.redMul(t),c=u;return[this.curve.jpoint(d,h,c),this.curve.jpoint(n,o,u)]}zaddc(e){J(e instanceof p);const t=this.x.redSub(e.x),r=this.y.redSub(e.y),i=this.y.redAdd(e.y),f=t.redSqr(),s=this.x.redMul(f),n=e.x.redMul(f),d=i.redSqr().redISub(s).redISub(n),o=r.redSqr().redISub(s).redISub(n),h=this.y.redMul(n.redISub(s)),u=e.y.redMuln(2).redIAdd(r),c=s.redISub(d),l=d.redAdd(c).redISub(o),a=u.redMul(c).redIAdd(h),b=r.redMul(l).redIAdd(h),m=this.z.redMul(t),S=m;return[this.curve.jpoint(o,b,S),this.curve.jpoint(d,a,m)]}zdblu(){const e=this.x.redSqr(),t=this.y.redSqr(),r=t.redSqr(),i=this.x.redAdd(t).redSqr(),f=e.redMuln(3);if(!this.curve.zeroA){const e=this.z.redPown(4);this.curve.threeA?f.redIAdd(e.redIMuln(-3)):f.redIAdd(this.curve.a.redMul(e))}const s=i.redISub(e).redISub(r).redIMuln(2),n=f.redSqr().redISub(s).redISub(s),d=r.redIMuln(8),o=s.redSub(n).redMul(f).redISub(d),h=this.y.redMul(this.z).redIMuln(2),u=h;return[this.curve.jpoint(n,o,u),this.curve.jpoint(s,d,h)]}recover(e,t,r,i){return this.toP().recover(e,t,r,i)}getX(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}getY(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.y.fromRed()}eq(e){if(J(e instanceof p),this===e)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return!1;if(this.z.eq(e.z))return this.x.eq(e.x)&&this.y.eq(e.y);const t=this.z.redSqr(),r=e.z.redSqr(),i=this.x.redMul(r),f=e.x.redMul(t);if(!i.eq(f))return!1;const s=t.redMul(this.z),n=r.redMul(e.z),d=this.y.redMul(n),o=e.y.redMul(s);return d.eq(o)}cmp(e){J(e instanceof p);const t=this.isInfinity(),r=e.isInfinity();return t&&!r?-1:!t&&r?1:t&&r?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}isInfinity(){return this.z.isZero()}isOrder2(){return!this.isInfinity()&&this.y.isZero()}isOdd(){return!this.isInfinity()&&(this.normalize(),this.y.redIsOdd())}isEven(){return!this.isInfinity()&&(this.normalize(),this.y.redIsEven())}isSquare(){return!this.isInfinity()&&-1!==this.y.redMul(this.z).redJacobi()}eqX(e){if(J(e instanceof f),J(!e.red),this.isInfinity())return!1;const t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);return this.x.eq(r)}eqR(e){if(J(e instanceof f),J(!e.red),!this.curve.smallGap)return this.toP().eqR(e);if(this.isInfinity())return!1;if(e.cmp(this.curve.p)>=0)return!1;const t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(this.x.eq(r))return!0;if(this.curve.highOrder)return!1;if(e.cmp(this.curve.pmodn)>=0)return!1;const i=this.curve.redN.redMul(t);return r.redIAdd(i),this.x.eq(r)}toP(){return this.isInfinity()?this.curve.point():(this.normalize(),this.curve.point(this.x,this.y))}toJ(){return this}encode(e){return this.toP().encode(e)}static decode(e,t){return b.decode(e,t).toJ()}encodeX(){return this.toP().encodeX()}static decodeEven(e,t){return b.decodeEven(e,t).toJ()}static decodeSquare(e,t){return b.decodeSquare(e,t).toJ()}toJSON(e){return this.toP().toJSON(e)}toPretty(){return this.toP().toPretty()}static fromJSON(e,t){return b.fromJSON(e,t).toJ()}[i](){return this.isInfinity()?"<JPoint: Infinity>":"<JPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class m extends c{constructor(e){super(S,"mont",e),this.a=f.fromJSON(e.a).toRed(this.red),this.b=f.fromJSON(e.b).toRed(this.red),this.bi=this.b.redInvert(),this.a2=this.a.redAdd(this.two),this.a24=this.a2.redMul(this.i4),this.a3=this.a.redMul(this.i3),this.a0=this.a.redMul(this.bi),this.b0=this.bi.redSqr(),this._finalize(e)}static _isomorphism(e,t,r){J(e instanceof f),J(t instanceof f),J(r instanceof f);const i=e.clone(),s=r.clone();if(1!==t.redDiv(r).redJacobi())throw new Error("Invalid `b` coefficient.");return[i,s]}_short(e,t){const{a:r,b:i,three:f}=this,s=r.redSqr(),n=s.redMul(r),d=i.redSqr(),o=d.redMul(i),h=f.redSub(s),u=d.redMuln(3),c=n.redMuln(2).redISub(r.redMuln(9)),l=o.redMuln(27),b=h.redDiv(u),p=c.redDiv(l);return null!=e?a._isomorphism(b,p,e,t):[b,p]}_mont(e){return m._isomorphism(this.a,this.b,e)}_edwards(e,t=!1){J("boolean"===typeof t);const{two:r,bi:i}=this,f=this.a.redAdd(r).redMul(i),s=this.a.redSub(r).redMul(i);return t&&f.swap(s),null!=e?w._isomorphism(f,s,e):[f,s]}_scaleShort(e){J(e instanceof a);const[t,r]=e._scale(this);return[this.field(t.redInvert()),this.field(r.redInvert())]}_scaleMont(e){return J(e instanceof m),this.g.isInfinity()||e.g.isInfinity()?this.field(e.b).redDivSqrt(this.b):this.g.y.redDiv(this.field(e.g.y))}_scaleEdwards(e,t){J(e instanceof w);const r=e._scale(this,t);return this.field(r)}_solveY0(e){J(e instanceof f);const t=this.a0,r=this.b0,i=e.redSqr();return i.redMul(e).redIAdd(t.redMul(i)).redIAdd(r.redMul(e))}_elligator2(e){const t=this.a0.redNeg(),r=this.one.redAdd(this.z.redMul(e.redSqr()));r.cinject(this.one,r.czero());const i=t.redMul(r.redFermat()),f=i.redNeg().redISub(this.a0),s=this._solveY0(i),n=this._solveY0(f),d=0|s.redIsSquare(),o=i.cinject(f,1^d),h=s.cinject(n,1^d).redSqrt();h.cinject(h.redNeg(),h.redIsOdd()^e.redIsOdd());const u=this.b.redMul(o),c=this.b.redMul(h);return this.point(u,c)}_invert2(e,t){const{x:r,y:i}=e,f=1&t,s=r.redMul(this.bi),n=i.redMul(this.bi),d=s.redAdd(this.a0),o=s;d.cswap(o,f);const h=d.redINeg(),u=o.redMul(this.z),[c,l]=P(h,u);if(l.cinject(l.redNeg(),l.redIsOdd()^n.redIsOdd()),!c)throw new Error("Invalid point.");return l}_constMul(e,t,r){J(e instanceof S);const i=e.toX(),[f,s]=i.ladderConst(t,r),n=e.recover(f,s);return t.isNeg()?n.neg():n}isElliptic(){const e=this.a.redSqr();return!this.b.redMul(e.redSub(this.four)).isZero()}jinv(){const{a:e,three:t,four:r}=this,i=e.redSqr(),f=i.redSub(t).redPown(3).redIMuln(256),s=i.redSub(r);if(s.isZero())throw new Error("Curve is not elliptic.");return f.redDiv(s).fromRed()}point(e,t,r=0){return new S(this,e,t,r)}jpoint(e,t,r){return J(null==e&&null==t&&null==r),this.point()}xpoint(e,t){return new M(this,e,t)}solveY2(e){J(e instanceof f);const t=e.redSqr();return t.redMul(e).redIAdd(this.a.redMul(t)).redIAdd(e).redMul(this.bi)}validate(e){if(J(e instanceof S),e.isInfinity())return!0;const{x:t,y:r}=e,i=this.solveY2(t);return r.redSqr().eq(i)}pointFromX(e,t=null){J(e instanceof f),J(null==t||"boolean"===typeof t),e.red||(e=e.toRed(this.red));const r=this.solveY(e);if(null!=t){if(r.isZero()&&t)throw new Error("Invalid point.");r.redIsOdd()!==t&&r.redINeg()}return this.point(e,r)}isIsomorphic(e,t){if(J(e instanceof c),!e.p.eq(this.p))return!1;if("mont"===e.type){const t=this.field(e.a),r=this.field(e.b);if(!this.a.eq(t))return!1;if(this.b.isZero())return!1;return 1===r.redDiv(this.b).redJacobi()}return e.isIsomorphic(this,t)}isIsogenous(e){return J(e instanceof c),"mont"!==e.type&&e.isIsogenous(this)}pointFromShort(e){if(J(e instanceof b),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();const{a3:t,b:r}=this,[i,f]=this._scale(e.curve),s=this.field(e.x).redMul(i),n=this.field(e.y).redMul(f),d=r.redMul(s).redISub(t),o=r.redMul(n);return this.point(d,o)}throw new Error("Not implemented.")}pointFromMont(e){if(J(e instanceof S),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();const t=this._scale(e.curve),r=this.field(e.x),i=this.field(e.y),f=r,s=t.redMul(i);return this.point(f,s)}throw new Error("Not implemented.")}pointFromEdwards(e){J(e instanceof I),J(e.curve.p.eq(this.p));const t=this.field(e.x),r=this.field(e.y),i=this.field(e.z);if(this.isIsogenous(e.curve)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);const f=i.redSqr().redIMuln(2),s=r.redSqr(),n=t.redSqr(),d=f.redISub(n).redISub(s).redMul(r),o=n.redMul(t);return this.cpoint(s,n,d,o)}if(this.isIsomorphic(e.curve,!0)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);const f=this._scale(e.curve,!0),s=r.redAdd(i),n=r.redSub(i),d=f.redMul(i).redMul(s),o=t.redMul(n);return this.cpoint(s,n,d,o)}if(this.isIsomorphic(e.curve,!1)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.zero);const f=this._scale(e.curve,!1),s=i.redAdd(r),n=i.redSub(r),d=f.redMul(i).redMul(s),o=t.redMul(n);return this.cpoint(s,n,d,o)}throw new Error("Not implemented.")}pointFromUniform(e){if(J(e instanceof f),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");return this._elligator2(e)}pointToUniform(e,t){if(J(e instanceof S),J(t>>>0===t),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");if(e.isInfinity())throw new Error("Invalid point.");const r=(t>>>4&15)%this.torsion.length,i=e.add(this.torsion[r]);return this._invert2(i,t)}decodePoint(e,t){return S.decode(this,e,t)}encodeX(e){return J(e instanceof M),e.encode()}decodeX(e){return M.decode(this,e)}toShort(e,t,r=null){const[i,f]=this._short(e,t),s=new a({red:this.red,prime:this.prime,p:this.p,a:i,b:f,n:this.n,h:this.h});if(null!=r){const[,e]=s._scale(this);e.redIsOdd()!==r&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromMont(this.g));for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromMont(this.torsion[n]);return s}toMont(e,t=null){const[r,i]=this._mont(e),f=new m({red:this.red,prime:this.prime,p:this.p,a:r,b:i,n:this.n,h:this.h,z:this.z});if(null!=t){const e=f._scale(this);e.redIsOdd()!==t&&e.redINeg()}this.g.isInfinity()||(f.g=f.pointFromMont(this.g));for(let s=0;s<this.h.word(0);s++)f.torsion[s]=f.pointFromMont(this.torsion[s]);return f}toEdwards(e,t,r=null){const[i,f]=this._edwards(e,t),s=new w({red:this.red,prime:this.prime,p:this.p,a:i,d:f,n:this.n,h:this.h,z:this.z});if(null!=r){const e=s._scale(this,t);e.redIsOdd()!==r&&e.redINeg()}if(this.g.isInfinity()||(s.g=s.pointFromMont(this.g),s.g.normalize()),s.isComplete())for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromMont(this.torsion[n]),s.torsion[n].normalize();return s}pointFromJSON(e){return S.fromJSON(this,e)}toJSON(e){const t=super.toJSON(e);return t.a=this.a.fromRed().toJSON(),t.b=this.b.fromRed().toJSON(),t}}class S extends l{constructor(e,t,r,i){J(e instanceof m),super(e,s),this.x=this.curve.zero,this.y=this.curve.zero,this.inf=1,null!=t&&this._init(t,r,i)}_init(e,t,r){J(e instanceof f),J(t instanceof f),this.x=e,this.y=t,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=0|r}clone(){return this.curve.point(this.x.clone(),this.y.clone(),this.inf)}swap(e,t){J(e instanceof S);const r=1&(t>>31|-t>>31),i=this.inf,f=e.inf;return this.x.cswap(e.x,t),this.y.cswap(e.y,t),this.inf=i&(1^r)|f&r,e.inf=f&(1^r)|i&r,this}scale(e){return this.clone()}randomize(e){return this.clone()}neg(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}add(e){if(J(e instanceof S),this.inf)return e;if(e.inf)return this;if(this.x.eq(e.x))return this.y.eq(e.y)?this.dbl():this.curve.point();const t=e.x.redSub(this.x),r=e.y.redSub(this.y).redDiv(t),i=this.curve.b.redMul(r.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(e.x),f=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,f)}dbl(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();const e=this.x.redSqr().redIMuln(3),t=this.curve.a.redMul(this.x).redIMuln(2),r=e.redIAdd(t).redIAdd(this.curve.one),i=this.curve.b.redMul(this.y).redIMuln(2),f=r.redDiv(i),s=this.curve.b.redMul(f.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(this.x),n=f.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,n)}uadd(e){J(e instanceof S);const t=e.x.redSub(this.x),r=e.y.redSub(this.y),i=this.x.redSqr().redIMuln(3),f=this.curve.a.redMul(this.x).redIMuln(2),s=i.redIAdd(f).redIAdd(this.curve.one),n=this.curve.b.redMul(this.y).redIMuln(2),d=t.czero()&r.czero();r.cinject(s,d),t.cinject(n,d);const o=t.czero()&(1^(this.inf|e.inf));t.cinject(this.curve.one,t.czero());const h=r.redMul(t.redFermat()),u=this.curve.b.redMul(h.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(e.x),c=h.redMul(this.x.redSub(u)).redISub(this.y),l=o|this.inf&e.inf;return u.cinject(e.x,this.inf),c.cinject(e.y,this.inf),u.cinject(this.x,e.inf),c.cinject(this.y,e.inf),u.cinject(this.curve.zero,l),c.cinject(this.curve.zero,l),this.curve.point(u,c,l)}udbl(){return this.uadd(this)}recover(e,t){if(J(e instanceof M),J(t instanceof M),this.inf)return this.curve.point();const r=this.x.redMul(e.z),i=e.x.redAdd(r),f=e.x.redSub(r).redSqr().redMul(t.x),s=this.curve.a.redMul(e.z).redIMuln(2),n=i.redIAdd(s),d=this.x.redMul(e.x).redIAdd(e.z),o=n.redMul(d),h=s.redMul(e.z),u=o.redISub(h).redMul(t.z),c=this.curve.b.redMul(this.y).redIMuln(2).redMul(e.z).redMul(t.z),l=c.redMul(e.x),a=u.redISub(f),b=c.redMul(e.z);if(b.isZero())return this.curve.point();const p=b.redInvert(),m=l.redMul(p),S=a.redMul(p);return this.curve.point(m,S)}getX(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}getY(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}eq(e){return J(e instanceof S),this===e||(this.inf?0!==e.inf:!e.inf&&(this.x.eq(e.x)&&this.y.eq(e.y)))}cmp(e){return J(e instanceof S),this.inf&&!e.inf?-1:!this.inf&&e.inf?1:this.inf&&e.inf?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())||this.getY().cmp(e.getY())}isInfinity(){return 0!==this.inf}isOrder2(){return!this.inf&&this.y.isZero()}isOdd(){return!this.inf&&this.y.redIsOdd()}isEven(){return!this.inf&&this.y.redIsEven()}toP(){return this}toJ(){return this}toX(){return this.inf?this.curve.xpoint():this.curve.xpoint(this.x,this.curve.one)}encode(){return this.toX().encode()}static decode(e,t,r){return J(e instanceof m),e.decodeX(t).toP(r)}toJSON(e){if(this.inf)return[];return[this.getX().toJSON(),this.getY().toJSON()]}toPretty(){if(this.inf)return[];const e=2*this.curve.fieldSize;return[D(this.getX(),e),D(this.getY(),e)]}static fromJSON(e,t){if(J(e instanceof m),J(Array.isArray(t)),J(0===t.length||2===t.length||3===t.length),0===t.length)return e.point();const r=f.fromJSON(t[0]),i=f.fromJSON(t[1]);return e.point(r,i)}[i](){return this.inf?"<MontPoint: Infinity>":"<MontPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}}class M extends l{constructor(e,t,r){J(e instanceof m),super(e,d),this.x=this.curve.one,this.z=this.curve.zero,null!=t&&this._init(t,r)}_init(e,t){J(e instanceof f),J(null==t||t instanceof f),this.x=e,this.z=t||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red))}clone(){return this.curve.xpoint(this.x.clone(),this.z.clone())}swap(e,t){return J(e instanceof M),this.x.cswap(e.x,t),this.z.cswap(e.z,t),this}precompute(e,t){return this}validate(){if(this.isInfinity())return!0;const{x:e,z:t}=this,r=e.redSqr(),i=r.redMul(e),f=t.redSqr(),s=this.curve.a.redMul(r).redMul(t);return-1!==i.redIAdd(s).redIAdd(e.redMul(f)).redMul(this.curve.bi).redMul(t).redJacobi()}normalize(){return this.isInfinity()||this.z.eq(this.curve.one)||(this.x=this.x.redDiv(this.z),this.z=this.curve.one),this}scale(e){if(J(e instanceof f),this.isInfinity())return this.curve.xpoint();const t=this.x.redMul(e),r=this.z.redMul(e);return this.curve.xpoint(t,r)}neg(){return this}dbl(){const e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),r=e.redSub(t),i=e.redMul(t),f=r.redMul(t.redIAdd(this.curve.a24.redMul(r)));return this.curve.xpoint(i,f)}diffAdd(e,t){J(e instanceof M),J(t instanceof M);const r=e.x.redAdd(e.z),i=e.x.redSub(e.z),f=t.x.redAdd(t.z),s=t.x.redSub(t.z).redMul(r),n=f.redMul(i),d=this.z.redMul(s.redAdd(n).redSqr()),o=this.x.redMul(s.redISub(n).redSqr());return this.curve.xpoint(d,o)}diffAddDbl(e,t){J(e instanceof M),J(t instanceof M);const r=e.x.redAdd(e.z),i=r.redSqr(),f=e.x.redSub(e.z),s=f.redSqr(),n=i.redSub(s),d=t.x.redAdd(t.z),o=t.x.redSub(t.z).redMul(r),h=d.redMul(f),u=this.z.redMul(o.redAdd(h).redSqr()),c=this.x.redMul(o.redISub(h).redSqr()),l=i.redMul(s),a=n.redMul(s.redIAdd(this.curve.a24.redMul(n)));return[this.curve.xpoint(l,a),this.curve.xpoint(u,c)]}getX(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}getY(e){return this.toP(e).getY()}eq(e){if(J(e instanceof M),this===e)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return!1;if(this.z.eq(e.z))return this.x.eq(e.x);const t=this.x.redMul(e.z),r=e.x.redMul(this.z);return t.eq(r)}cmp(e){J(e instanceof M);const t=this.isInfinity(),r=e.isInfinity();return t&&!r?-1:!t&&r?1:t&&r?0:this.order().cmp(e.order())||this.getX().cmp(e.getX())}isInfinity(){return this.z.isZero()}isOrder2(){return!this.isInfinity()&&this.x.isZero()}isOdd(){return!1}isEven(){return!1}hasTorsion(){return!this.isInfinity()&&(!!this.x.isZero()||super.hasTorsion())}order(){try{return this.toP().order()}catch(e){return new f(1)}}jmul(e){return this.ladder(e)[0]}jmulSimple(e){return this.ladderSimple(e)[0]}jmulBlind(e,t){return this.ladderBlind(e,t)[0]}jmulConst(e,t){return this.ladderConst(e,t)[0]}jmulAdd(e,t,r){throw new Error("Not implemented.")}jmulAddSimple(e,t,r){throw new Error("Not implemented.")}ladder(e){J(e instanceof f),J(!e.red);const t=e.bitLength();let r=this.curve.xpoint(),i=this;for(let f=t-1;f>=0;f--){0===e.bit(f)?[r,i]=this.diffAddDbl(r,i):[i,r]=this.diffAddDbl(i,r)}return[r,i]}ladderSimple(e){J(e instanceof f),J(!e.red);const t=e.bitLength();let r=this.curve.xpoint(),i=this;for(let f=t-1;f>=0;f--){0===e.bit(f)?(i=this.diffAdd(i,r),r=r.dbl()):(r=this.diffAdd(r,i),i=i.dbl())}return[r,i]}ladderBlind(e,t){return t?this.randomize(t).ladder(e):this.ladder(e)}ladderConst(e,t){J(e instanceof f),J(!e.red);const r=Math.max(e.bitLength(),this.curve.fieldBits),i=r+7>>>3,s=e.toArray("le",i),n=t?this.randomize(t):this;let d=this.curve.xpoint().clone(),o=n.clone(),h=0;for(let f=r-1;f>=0;f--){const e=s[f>>3]>>(7&f)&1;d.swap(o,h^e),[d,o]=n.diffAddDbl(d,o),h=e}return d.swap(o,h),[d,o]}toP(e=null){return J(null==e||"boolean"===typeof e),this.isInfinity()?this.curve.point():(this.normalize(),this.curve.pointFromX(this.x,e))}toJ(){return this}toX(){return this}key(){if(this.isInfinity())return this.curve.uid+":oo";this.normalize();const e=this.getX().toString(16);return`${this.curve.uid}:${e}`}encode(){return this.curve.encodeField(this.getX())}static decode(e,t){J(e instanceof m);const r=e.decodeField(t);r.iumaskn(e.fieldBits);const i=e.xpoint(r,e.one);return J(!i.isInfinity()),i}toJSON(e){return this.toP().toJSON(e)}toPretty(){return this.toP().toPretty()}static fromJSON(e,t){return S.fromJSON(e,t).toX()}[i](){return this.isInfinity()?"<XPoint: Infinity>":"<XPoint: x="+this.x.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class w extends c{constructor(e){super(I,"edwards",e),this.a=f.fromJSON(e.a).toRed(this.red),this.d=f.fromJSON(e.d).toRed(this.red),this.s=f.fromJSON(e.s||"0").toRed(this.red),this.si=this.s.isZero()?this.zero:this.s.redInvert(),this.k=this.d.redMuln(2),this.smi=-this.d.redNeg().word(0),this.ad6=this.a.redAdd(this.d).redMul(this.i6),this.twisted=!this.a.eq(this.one),this.oneA=this.a.eq(this.one),this.mOneA=this.a.eq(this.one.redNeg()),this.smallD=null!=this.prime&&1===this.d.redNeg().length,this.alt=null,this._finalize(e)}static _isomorphism(e,t,r){J(e instanceof f),J(t instanceof f),J(r instanceof f);const i=r.clone(),s=r.redMul(t).redDiv(e);if(1!==e.redDiv(r).redJacobi())throw new Error("Invalid `a` coefficient.");return[i,s]}_short(e,t){const{a:r,d:i}=this,f=r.redSqr(),s=f.redMul(r),n=i.redSqr(),d=n.redMul(i),o=r.redMul(i).redIMuln(14),h=f.redMul(i),u=r.redMul(n),c=h.redIAdd(u).redIMuln(33),l=f.redAdd(o).redIAdd(n).redDivn(-48),b=c.redISub(s).redISub(d).redDivn(864);return null!=e?a._isomorphism(l,b,e,t):[l,b]}_mont(e,t=!1){let r,i;J("boolean"===typeof t),t?(r=this.d.redAdd(this.a),i=this.d.redSub(this.a)):(r=this.a.redAdd(this.d),i=this.a.redSub(this.d));const f=i.redInvert(),s=r.redMuln(2).redMul(f),n=f.redMuln(4);return null!=e?m._isomorphism(s,n,e):[s,n]}_edwards(e){return w._isomorphism(this.a,this.d,e)}_scaleShort(e){J(e instanceof a);const[t,r]=e._scale(this);return[this.field(t.redInvert()),this.field(r.redInvert())]}_scaleMont(e,t=!1){if(J(e instanceof m),J("boolean"===typeof t),this.g.isInfinity()||e.g.isInfinity()){const[r]=e._edwards(null,t);return this.field(r).redDivSqrt(this.a)}const r=e.g.x.redDiv(e.g.y);return this.g.x.redDiv(this.field(r))}_scaleEdwards(e){return J(e instanceof w),this.g.isInfinity()||e.g.isInfinity()?this.field(e.a).redDivSqrt(this.a):this.g.x.redDiv(this.field(e.g.x))}_mulA(e){return J(e instanceof f),this.oneA?e.clone():this.mOneA?e.redNeg():this.a.redMul(e)}_mulD(e){return J(e instanceof f),this.smallD?e.redMuln(this.smi):this.d.redMul(e)}_elligator1(e){const{s:t,si:r,i2:i,one:f,two:s}=this,n=r.redSqr().redIMuln(2),d=t.redSqr().redMul(i),o=d.redSqr(),h=n.redAdd(d),u=h.redSqr().redISub(s),c=n.redSub(f),l=this.p.subn(2),a=this.p.subn(1).iushrn(1),b=this.p.addn(1).iushrn(2),p=f.redSub(e),m=f.redAdd(e),S=p.redMul(m.redPow(l)),M=S.redSqr(),w=M.redMul(S),I=w.redMul(M).redAdd(u.redMul(w)).redIAdd(S),v=I.redPow(a),y=M.redAdd(o).redPow(a),g=v.redMul(y),z=v.redMul(S),x=v.redMul(I).redPow(b).redMul(g),A=f.redAdd(z),N=h.redMul(z),q=A.redSqr(),_=c.redMul(t).redMul(z).redMul(A),O=x.cinject(this.one,S.czero()),E=N.redSub(q),J=N.redAdd(q);return this.cpoint(_,O,E,J)}_invert1(e,t){const{s:r,si:i,i2:f,one:s}=this,{x:n,y:d,z:o}=e,h=1&t,u=i.redSqr().redIMuln(2),c=r.redSqr().redMul(f),l=c.redSqr(),a=u.redAdd(c),b=u.redSub(s),p=this.p.subn(2),m=this.p.subn(1).iushrn(1),S=this.p.addn(1).iushrn(2),M=d.redSub(o),w=d.redAdd(o).redIMuln(2),I=M.redMul(w.redPow(p)),v=s.redAdd(I.redMul(a)),y=v.redSqr().redISub(s),g=y.redPow(S),z=g.redSqr().ceq(y),x=g.redSub(v),A=s.redAdd(x),N=b.redMul(r).redMul(x).redMul(A).redMul(n.redMul(o)),q=x.redSqr().redIAdd(l),_=N.redMul(q).redPow(m).redMul(x),O=s.redSub(_),E=s.redAdd(_),J=O.redMul(E.redPow(p));if(J.cinject(J.redNeg(),J.redIsOdd()^h),!z)throw new Error("Invalid point.");return J}_alt(){return this.alt||(this.alt=this.toMont()),this.alt}isElliptic(){const e=this.a.redMul(this.d),t=this.a.redSub(this.d);return!e.redMul(t).isZero()}jinv(){const{a:e,d:t}=this,r=e.redMul(t),i=e.redSub(t).redPown(4),f=e.redSqr(),s=t.redSqr(),n=f.redAdd(r.redMuln(14)).redIAdd(s).redPown(3).redIMuln(16),d=r.redMul(i);if(d.isZero())throw new Error("Curve is not elliptic.");return n.redDiv(d).fromRed()}isComplete(){return 1===this.a.redJacobi()&&-1===this.d.redJacobi()}point(e,t,r,i){return new I(this,e,t,r,i)}jpoint(e,t,r){return J(null==e&&null==t&&null==r),this.point()}cpoint(e,t,r,i){J(e instanceof f),J(t instanceof f),J(r instanceof f),J(i instanceof f);const s=e.redMul(i),n=r.redMul(t),d=t.redMul(i),o=e.redMul(r);return this.point(s,n,d,o)}solveX2(e){J(e instanceof f);const t=e.redSqr(),r=this._mulD(t).redISub(this.a);return t.redISub(this.one).redDiv(r)}solveX(e){const t=e.redSqr(),r=this._mulD(t).redISub(this.a);return t.redISub(this.one).redDivSqrt(r)}solveY2(e){J(e instanceof f);const t=e.redSqr(),r=this._mulA(t).redISub(this.one),i=this._mulD(t).redISub(this.one);return r.redDiv(i)}solveY(e){const t=e.redSqr(),r=this._mulA(t).redISub(this.one),i=this._mulD(t).redISub(this.one);return r.redDivSqrt(i)}validate(e){if(J(e instanceof I),e.zOne){const t=e.x.redSqr(),r=e.y.redSqr(),i=this._mulD(t).redMul(r),f=this._mulA(t).redIAdd(r),s=this.one.redAdd(i),n=e.t,d=e.x.redMul(e.y);return f.eq(s)&&n.eq(d)}const t=e.x.redSqr(),r=e.y.redSqr(),i=e.z.redSqr(),f=i.redSqr(),s=this._mulD(t).redMul(r),n=this._mulA(t).redIAdd(r).redMul(i),d=f.redIAdd(s),o=e.t.redMul(e.z),h=e.x.redMul(e.y);return n.eq(d)&&o.eq(h)}pointFromX(e,t=null){J(e instanceof f),J(null==t||"boolean"===typeof t),e.red||(e=e.toRed(this.red));const r=this.solveY(e);if(null!=t){if(r.isZero()&&t)throw new Error("Invalid point.");r.redIsOdd()!==t&&r.redINeg()}return this.point(e,r)}pointFromY(e,t=null){J(e instanceof f),J(null==t||"boolean"===typeof t),e.red||(e=e.toRed(this.red));const r=this.solveX(e);if(null!=t){if(r.isZero()&&t)throw new Error("Invalid point.");r.redIsOdd()!==t&&r.redINeg()}return this.point(r,e)}isIsomorphic(e,t=!1){if(J(e instanceof c),J("boolean"===typeof t),!e.p.eq(this.p))return!1;if("short"===e.type)return e.isIsomorphic(this);if("mont"===e.type){const r=this.field(e.a);let i,f;return t?(i=this.d.redAdd(this.a),f=this.d.redSub(this.a)):(i=this.a.redAdd(this.d),f=this.a.redSub(this.d)),r.redMul(f).eq(i.redIMuln(2))}if("edwards"===e.type){const t=this.field(e.a),r=this.field(e.d);return this.a.redMul(r).eq(t.redMul(this.d))}return!1}isIsogenous(e){if(J(e instanceof c),!e.p.eq(this.p))return!1;if("mont"===e.type){if(!this.a.eq(this.one))return!1;const t=this.field(e.a),r=this.field(e.b),i=this.two.redSub(this.d.redMuln(4));return t.eq(i)&&r.eq(this.one)}if("edwards"===e.type){const t=this.field(e.a),r=this.field(e.d);return t.eq(this.a.redNeg())&&r.eq(this.d.redSub(this.a))}return!1}pointFromShort(e){if(J(e instanceof b),this.isIsomorphic(e.curve)){if(e.isInfinity())return this.point();if(e.y.isZero())return this.point(this.zero,this.one.redNeg());const{a:t,d:r}=this,[i,f]=this._scale(e.curve),s=t.redMuln(5),n=r.redMuln(5),d=this.field(e.x).redMul(i),o=this.field(e.y).redMul(f),h=d.redMuln(6),u=d.redMuln(12),c=h.redSub(t).redISub(r),l=o.redMuln(6),a=u.redSub(s).redIAdd(r),b=u.redAdd(t).redISub(n);return this.cpoint(c,l,a,b)}throw new Error("Not implemented.")}pointFromMont(e){J(e instanceof S),J(e.curve.p.eq(this.p));const t=this.field(e.x),r=this.field(e.y);if(this.isIsogenous(e.curve)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point();const i=t.redSqr(),f=i.redMul(t),s=f.redMul(t),n=s.redMul(t),d=r.redSqr(),o=r.redMuln(4),h=i.redSub(this.one),u=i.redMuln(2),c=d.redMuln(4),l=f.redIMuln(2),a=t.redMul(d).redIMuln(4),b=i.redMul(d).redIMuln(2),p=d.redIMuln(2),m=o.redMul(h),S=s.redISub(u).redIAdd(c).redIAdd(this.one),M=n.redSub(l).redISub(a).redIAdd(t).redINeg(),w=n.redISub(b).redISub(l).redISub(p).redIAdd(t);return this.cpoint(m,S,M,w).divn(4)}if(this.isIsomorphic(e.curve,!0)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.one.redNeg());const i=this._scale(e.curve,!0).redMul(t),f=r,s=t.redAdd(this.one),n=t.redSub(this.one);return this.cpoint(i,f,s,n)}if(this.isIsomorphic(e.curve,!1)){if(e.isInfinity())return this.point();if(e.x.isZero())return this.point(this.zero,this.one.redNeg());const i=this._scale(e.curve,!1).redMul(t),f=r,s=t.redSub(this.one),n=t.redAdd(this.one);return this.cpoint(i,f,s,n)}throw new Error("Not implemented.")}pointFromEdwards(e){J(e instanceof I),J(e.curve.p.eq(this.p));const t=this.field(e.curve.a),r=this.field(e.x),i=this.field(e.y),f=this.field(e.z),s=this.field(e.t);if(this.isIsogenous(e.curve)){const e=r.redMul(i),s=r.redSqr(),n=i.redSqr(),d=f.redSqr(),o=t.redMul(s),h=e.redIMuln(2),u=n.redSub(o),c=n.redAdd(o),l=d.redIMuln(2).redISub(c),a=this.cpoint(h,u,c,l);return this.twisted?a:a.divn(4)}if(this.isIsomorphic(e.curve)){const t=this._scale(e.curve),n=t.redMul(r),d=i,o=f,h=t.redMul(s);return this.point(n,d,o,h)}throw new Error("Not implemented.")}pointFromUniform(e,t=null){J(e instanceof f),J(e.red===this.red),J(null==t||t instanceof m),t||(t=this._alt());const r=t.field(e),i=t.pointFromUniform(r);return this.pointFromMont(i)}pointToUniform(e,t,r=null){J(e instanceof I),J(t>>>0===t),J(null==r||r instanceof m),r||(r=this._alt());const i=(t>>4&15)%this.torsion.length,f=e.add(this.torsion[i]),s=r.pointFromEdwards(f),n=r.pointToUniform(s,15&t);return this.field(n)}pointFromHash(e,t,r=null){J(null==r||r instanceof m),r||(r=this._alt());const i=r.pointFromHash(e,t);return this.pointFromMont(i)}pointToHash(e,t,r,i=null){J(e instanceof I),J(t>>>0===t),J(null==i||i instanceof m),i||(i=this._alt());const f=t%this.torsion.length,s=e.add(this.torsion[f]),n=i.pointFromEdwards(s);return i.pointToHash(n,0,r)}decodePoint(e){return I.decode(this,e)}toShort(e,t,r=null){const[i,f]=this._short(e,t),s=new a({red:this.red,prime:this.prime,p:this.p,a:i,b:f,n:this.n,h:this.h});if(null!=r){const[,e]=s._scale(this);e.redIsOdd()!==r&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromEdwards(this.g));for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromEdwards(this.torsion[n]);return s}toMont(e,t,r=null){const[i,f]=this._mont(e,t),s=new m({red:this.red,prime:this.prime,p:this.p,a:i,b:f,n:this.n,h:this.h,z:this.z});if(null!=r){const e=this._scale(s,t);e.redIsOdd()!==r&&e.redINeg()}this.g.isInfinity()||(s.g=s.pointFromEdwards(this.g));for(let n=0;n<this.h.word(0);n++)s.torsion[n]=s.pointFromEdwards(this.torsion[n]);return s}toEdwards(e,t=null){const[r,i]=this._edwards(e),f=new w({red:this.red,prime:this.prime,p:this.p,a:r,d:i,n:this.n,h:this.h,z:this.z});if(null!=t){const e=f._scale(this);e.redIsOdd()!==t&&e.redINeg()}if(this.g.isInfinity()||(f.g=f.pointFromEdwards(this.g),f.g.normalize()),f.isComplete())for(let s=0;s<this.h.word(0);s++)f.torsion[s]=f.pointFromEdwards(this.torsion[s]),f.torsion[s].normalize();return f}pointFromJSON(e){return I.fromJSON(this,e)}toJSON(e){const t=super.toJSON(e);return t.a=this.a.fromRed().toJSON(),t.d=this.d.fromRed().toJSON(),this.s.isZero()||(t.s=this.s.fromRed().toJSON()),t}}class I extends l{constructor(e,t,r,i,f){J(e instanceof w),super(e,o),this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=1,null!=t&&this._init(t,r,i,f)}_init(e,t,r,i){J(e instanceof f),J(t instanceof f),J(null==r||r instanceof f),J(null==i||i instanceof f),this.x=e,this.y=t,this.z=r||this.curve.one,this.t=i||null,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=0|this.z.eq(this.curve.one),this._check(),this.t||(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redDiv(this.z)))}_check(){if(this.z.isZero())throw new Error("Invalid point.")}clone(){return this.curve.point(this.x.clone(),this.y.clone(),this.z.clone(),this.t.clone())}swap(e,t){J(e instanceof I);const r=1&(t>>31|-t>>31),i=this.zOne,f=e.zOne;return this.x.cswap(e.x,t),this.y.cswap(e.y,t),this.z.cswap(e.z,t),this.t.cswap(e.t,t),this.zOne=i&(1^r)|f&r,e.zOne=f&(1^r)|i&r,this}normalize(){if(this.zOne)return this;const e=this.z.redInvert();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t=this.t.redMul(e),this.z=this.curve.one,this.zOne=1,this}scale(e){J(e instanceof f);const t=this.x.redMul(e),r=this.y.redMul(e),i=this.z.redMul(e),s=this.t.redMul(e);return this.curve.point(t,r,i,s)}neg(){const e=this.x.redNeg(),t=this.y,r=this.z,i=this.t.redNeg();return this.curve.point(e,t,r,i)}add(e){return J(e instanceof I),this.isInfinity()?e:e.isInfinity()?this:this.zOne?e._add(this,0):this._add(e,0)}_add(e,t){return this.curve.mOneA?this._addM1(e,t):this._addA(e,t)}_addM1(e,t){const r=e.zOne&(1^t),i=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),f=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),s=this.t.redMul(this.curve.k).redMul(e.t),n=r?this.z.redAdd(this.z):this.z.redMul(e.z).redIMuln(2),d=f.redSub(i),o=n.redSub(s),h=n.redIAdd(s),u=f.redIAdd(i),c=d.redMul(o),l=h.redMul(u),a=d.redMul(u),b=o.redMul(h);return this.curve.point(c,l,b,a)}_addA(e,t){const r=e.zOne&(1^t),i=this.x.redMul(e.x),f=this.y.redMul(e.y),s=this.curve._mulD(this.t).redMul(e.t),n=r?this.z.clone():this.z.redMul(e.z),d=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(i).redISub(f),o=n.redSub(s),h=n.redIAdd(s),u=f.redISub(this.curve._mulA(i)),c=d.redMul(o),l=h.redMul(u),a=d.redMul(u),b=o.redMul(h);return this.curve.point(c,l,b,a)}dbl(){return this.isInfinity()?this:this._dbl(0)}_dbl(e){const t=this.zOne&(1^e),r=this.x.redSqr(),i=this.y.redSqr(),f=t?this.curve.two:this.z.redSqr().redIMuln(2),s=this.curve._mulA(r),n=this.x.redAdd(this.y).redSqr().redISub(r).redISub(i),d=s.redAdd(i),o=d.redSub(f),h=s.redISub(i),u=n.redMul(o),c=d.redMul(h),l=n.redMul(h),a=o.redMul(d);return this.curve.point(u,c,a,l)}uadd(e){return J(e instanceof I),this._add(e,1)}udbl(){return this._dbl(1)}getX(){return this.normalize(),this.x.fromRed()}getY(){return this.normalize(),this.y.fromRed()}eq(e){if(J(e instanceof I),J(!this.z.isZero()),J(!e.z.isZero()),this===e)return!0;if(this.z.eq(e.z))return this.x.eq(e.x)&&this.y.eq(e.y);const t=this.x.redMul(e.z),r=e.x.redMul(this.z);if(!t.eq(r))return!1;const i=this.y.redMul(e.z),f=e.y.redMul(this.z);return i.eq(f)}cmp(e){return J(e instanceof I),this.order().cmp(e.order())||this.getY().cmp(e.getY())||this.getX().cmp(e.getX())}isInfinity(){return J(!this.z.isZero()),!!this.x.isZero()&&this.y.eq(this.z)}isOrder2(){return!this.isInfinity()&&this.x.isZero()}isOdd(){return this.normalize(),this.x.redIsOdd()}isEven(){return this.normalize(),this.x.redIsEven()}toP(){return this.normalize()}toJ(){return this}encode(){const e=this.getY();return e.setn(this.curve.signBit,this.x.redIsOdd()),this.curve.encodeAdjusted(e)}static decode(e,t){J(e instanceof w);const r=e.decodeAdjusted(t),i=0!==r.testn(e.signBit);if(r.setn(e.signBit,0),r.cmp(e.p)>=0)throw new Error("Invalid point.");return e.pointFromY(r,i)}toJSON(e){if(this.isInfinity())return[];const t=this.getX().toJSON(),r=this.getY().toJSON();return!0===e&&this.pre?[t,r,this.pre.toJSON()]:[t,r]}toPretty(){const e=2*this.curve.fieldSize;return[D(this.getX(),e),D(this.getY(),e)]}static fromJSON(e,t){if(J(e instanceof w),J(Array.isArray(t)),J(0===t.length||2===t.length||3===t.length),0===t.length)return e.point();const r=f.fromJSON(t[0]),i=f.fromJSON(t[1]),s=e.point(r,i);return t.length>2&&null!=t[2]&&(s.pre=v.fromJSON(s,t[2])),s}[i](){return this.isInfinity()?"<EdwardsPoint: Infinity>":"<EdwardsPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class v{constructor(){this.naf=null,this.windows=null,this.doubles=null,this.blinding=null,this.beta=null}map(e){J("function"===typeof e);const t=new this.constructor;return this.naf&&(t.naf=this.naf.map(e)),this.doubles&&(t.doubles=this.doubles.map(e)),t}toJSON(){return{naf:this.naf?this.naf.toJSON():null,windows:this.windows?this.windows.toJSON():null,doubles:this.doubles?this.doubles.toJSON():null,blinding:this.blinding?this.blinding.toJSON():void 0}}fromJSON(e,t){return J(e instanceof l),J(t&&"object"===typeof t),null!=t.naf&&(this.naf=y.fromJSON(e,t.naf)),null!=t.windows&&(this.windows=g.fromJSON(e,t.windows)),null!=t.doubles&&(this.doubles=z.fromJSON(e,t.doubles)),null!=t.blinding&&(this.blinding=x.fromJSON(e,t.blinding)),this}static fromJSON(e,t){return(new this).fromJSON(e,t)}}class y{constructor(e,t){this.width=e,this.points=t}map(e){J("function"===typeof e);const{width:t}=this,r=[];for(const i of this.points)r.push(e(i));return new this.constructor(t,r)}toJSON(){return{width:this.width,points:this.points.slice(1).map(e=>e.toJSON())}}static fromJSON(e,t){J(e instanceof l),J(t&&"object"===typeof t),J(t.width>>>0===t.width),J(Array.isArray(t.points));const{curve:r}=e,{width:i}=t,f=[e];for(const s of t.points)f.push(r.pointFromJSON(s));return new this(i,f)}}class g{constructor(e,t,r){this.width=e,this.bits=t,this.points=r}toJSON(){return{width:this.width,bits:this.bits,points:this.points.slice(1).map(e=>e.toJSON())}}static fromJSON(e,t){J(e instanceof l),J(t&&"object"===typeof t),J(t.width>>>0===t.width),J(t.bits>>>0===t.bits),J(Array.isArray(t.points));const{curve:r}=e,{width:i,bits:f}=t,s=[e];for(const n of t.points)s.push(r.pointFromJSON(n));return new this(i,f,s)}}class z{constructor(e,t){this.step=e,this.points=t}map(e){J("function"===typeof e);const{step:t}=this,r=[];for(const i of this.points)r.push(e(i));return new this.constructor(t,r)}toJSON(){return{step:this.step,points:this.points.slice(1).map(e=>e.toJSON())}}static fromJSON(e,t){J(e instanceof l),J(t&&"object"===typeof t),J(t.step>>>0===t.step),J(Array.isArray(t.points));const{curve:r}=e,{step:i}=t,f=[e];for(const s of t.points)f.push(r.pointFromJSON(s));return new this(i,f)}}class x{constructor(e,t){this.blind=e,this.unblind=t}toJSON(){return{blind:this.blind.toJSON(),unblind:this.unblind.toJSON()}}static fromJSON(e,t){J(e instanceof l),J(t&&"object"===typeof t);const{curve:r}=e;return new this(f.fromJSON(t.blind),r.pointFromJSON(t.unblind))}}class A{constructor(e,t,r,i){this.beta=e,this.lambda=t,this.basis=r,this.pre=i}toJSON(){return{beta:this.beta.fromRed().toJSON(),lambda:this.lambda.toJSON(),basis:[this.basis[0].toJSON(),this.basis[1].toJSON()],pre:[this.pre[0].toJSON(),this.pre[1].toJSON()]}}static fromJSON(e,t){J(e instanceof c),J(t&&"object"===typeof t),J(Array.isArray(t.basis)),J(Array.isArray(t.pre)),J(2===t.basis.length),J(2===t.pre.length);return new this(f.fromJSON(t.beta).toRed(e.red),f.fromJSON(t.lambda),[N.fromJSON(t.basis[0]),N.fromJSON(t.basis[1])],[f.fromJSON(t.pre[0]),f.fromJSON(t.pre[1])])}}class N{constructor(e,t){this.a=e,this.b=t}toJSON(){return{a:this.a.toJSON(),b:this.b.toJSON()}}static fromJSON(e){J(e&&"object"===typeof e);return new this(f.fromJSON(e.a),f.fromJSON(e.b))}}const q={__proto__:null,P192:class extends a{constructor(e){super({id:"P192",ossl:"prime192v1",type:"short",endian:"be",hash:"SHA256",prime:"p192",p:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff fffffffc"],b:["64210519 e59c80e7 0fa7e9ab 72243049","feb8deec c146b9b1"],n:["ffffffff ffffffff ffffffff 99def836","146bc9b1 b4d22831"],h:"1",z:"-5",g:[["188da80e b03090f6 7cbf20eb 43a18800","f4ff0afd 82ff1012"],["07192b95 ffc8da78 631011ed 6b24cdd5","73f977a1 1e794811"],e]})}},P224:class extends a{constructor(e){super({id:"P224",ossl:"secp224r1",type:"short",endian:"be",hash:"SHA256",prime:"p224",p:["ffffffff ffffffff ffffffff ffffffff","00000000 00000000 00000001"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff fffffffe"],b:["b4050a85 0c04b3ab f5413256 5044b0b7","d7bfd8ba 270b3943 2355ffb4"],n:["ffffffff ffffffff ffffffff ffff16a2","e0b8f03e 13dd2945 5c5c2a3d"],h:"1",z:"1f",g:[["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3","56c21122 343280d6 115c1d21"],["bd376388 b5f723fb 4c22dfe6 cd4375a0","5a074764 44d58199 85007e34"],e]})}},P256:class extends a{constructor(e){super({id:"P256",ossl:"prime256v1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff ffffffff"],a:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff fffffffc"],b:["5ac635d8 aa3a93e7 b3ebbd55 769886bc","651d06b0 cc53b0f6 3bce3c3e 27d2604b"],n:["ffffffff 00000000 ffffffff ffffffff","bce6faad a7179e84 f3b9cac2 fc632551"],h:"1",z:"-a",g:[["6b17d1f2 e12c4247 f8bce6e5 63a440f2","77037d81 2deb33a0 f4a13945 d898c296"],["4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16","2bce3357 6b315ece cbb64068 37bf51f5"],e]})}},P384:class extends a{constructor(e){super({id:"P384",ossl:"secp384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 ffffffff"],a:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 fffffffc"],b:["b3312fa7 e23ee7e4 988e056b e3f82d19","181d9c6e fe814112 0314088f 5013875a","c656398d 8a2ed19d 2a85c8ed d3ec2aef"],n:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff c7634d81 f4372ddf","581a0db2 48b0a77a ecec196a ccc52973"],h:"1",z:"-c",g:[["aa87ca22 be8b0537 8eb1c71e f320ad74","6e1d3b62 8ba79b98 59f741e0 82542a38","5502f25d bf55296c 3a545e38 72760ab7"],["3617de4a 96262c6f 5d9e98bf 9292dc29","f8f41dbd 289a147c e9da3113 b5f0b8c0","0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"],e]})}},P521:class extends a{constructor(e){super({id:"P521",ossl:"secp521r1",type:"short",endian:"be",hash:"SHA512",prime:"p521",p:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff"],a:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffc"],b:["00000051 953eb961 8e1c9a1f 929a21a0","b68540ee a2da725b 99b315f3 b8b48991","8ef109e1 56193951 ec7e937b 1652c0bd","3bb1bf07 3573df88 3d2c34f1 ef451fd4","6b503f00"],n:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffa 51868783 bf2f966b 7fcc0148","f709a5d0 3bb5c9b8 899c47ae bb6fb71e","91386409"],h:"1",z:"-4",g:[["000000c6 858e06b7 0404e9cd 9e3ecb66","2395b442 9c648139 053fb521 f828af60","6b4d3dba a14b5e77 efe75928 fe1dc127","a2ffa8de 3348b3c1 856a429b f97e7e31","c2e5bd66"],["00000118 39296a78 9a3bc004 5c8a5fb4","2c7d1bd9 98f54449 579b4468 17afbd17","273e662c 97ee7299 5ef42640 c550b901","3fad0761 353c7086 a272c240 88be9476","9fd16650"],e]})}},SECP256K1:class extends a{constructor(e){super({id:"SECP256K1",ossl:"secp256k1",type:"short",endian:"be",hash:"SHA256",prime:"k256",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe fffffc2f"],a:"0",b:"7",n:["ffffffff ffffffff ffffffff fffffffe","baaedce6 af48a03b bfd25e8c d0364141"],h:"1",z:"1",c:["0a2d2ba9 3507f1df 233770c2 a797962c","c61f6d15 da14ecd4 7d8d27ae 1cd5f852"],g:[["79be667e f9dcbbac 55a06295 ce870b07","029bfcdb 2dce28d9 59f2815b 16f81798"],["483ada77 26a3c465 5da4fbfc 0e1108a8","fd17b448 a6855419 9c47d08f fb10d4b8"],e],endo:{beta:["7ae96a2b 657c0710 6e64479e ac3434e9","9cf04975 12f58995 c1396c28 719501ee"],lambda:["5363ad4c c05c30e0 a5261c02 8812645a","122e22ea 20816678 df02967c 1b23bd72"],basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],pre:["3086d221a7d46bcde86c90e49284eb153dab","-e4437ed6010e88286f547fa90abfe4c42212"]}})}},BRAINPOOLP256:class extends a{constructor(e){super({id:"BRAINPOOLP256",ossl:"brainpoolP256r1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["a9fb57db a1eea9bc 3e660a90 9d838d72","6e3bf623 d5262028 2013481d 1f6e5377"],a:["7d5a0975 fc2c3057 eef67530 417affe7","fb8055c1 26dc5c6c e94a4b44 f330b5d9"],b:["26dc5c6c e94a4b44 f330b5d9 bbd77cbf","95841629 5cf7e1ce 6bccdc18 ff8c07b6"],n:["a9fb57db a1eea9bc 3e660a90 9d838d71","8c397aa3 b561a6f7 901e0e82 974856a7"],h:"1",z:"-2",g:[["8bd2aeb9 cb7e57cb 2c4b482f fc81b7af","b9de27e1 e3bd23c2 3a4453bd 9ace3262"],["547ef835 c3dac4fd 97f8461a 14611dc9","c2774513 2ded8e54 5c1d54c7 2f046997"],e]})}},BRAINPOOLP384:class extends a{constructor(e){super({id:"BRAINPOOLP384",ossl:"brainpoolP384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b4 12b1da19 7fb71123","acd3a729 901d1a71 87470013 3107ec53"],a:["7bc382c6 3d8c150c 3c72080a ce05afa0","c2bea28e 4fb22787 139165ef ba91f90f","8aa5814a 503ad4eb 04a8c7dd 22ce2826"],b:["04a8c7dd 22ce2826 8b39b554 16f0447c","2fb77de1 07dcd2a6 2e880ea5 3eeb62d5","7cb43902 95dbc994 3ab78696 fa504c11"],n:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b3 1f166e6c ac0425a7","cf3ab6af 6b7fc310 3b883202 e9046565"],h:"1",z:"-5",g:[["1d1c64f0 68cf45ff a2a63a81 b7c13f6b","8847a3e7 7ef14fe3 db7fcafe 0cbd10e8","e826e034 36d646aa ef87b2e2 47d4af1e"],["8abe1d75 20f9c2a4 5cb1eb8e 95cfd552","62b70b29 feec5864 e19c054f f9912928","0e464621 77918111 42820341 263c5315"],e]})}},BRAINPOOLP512:class extends a{constructor(e){super({id:"BRAINPOOLP512",ossl:"brainpoolP512r1",type:"short",endian:"be",hash:"SHA512",prime:null,p:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330871","7d4d9b00 9bc66842 aecda12a e6a380e6","2881ff2f 2d82c685 28aa6056 583a48f3"],a:["7830a331 8b603b89 e2327145 ac234cc5","94cbdd8d 3df91610 a83441ca ea9863bc","2ded5d5a a8253aa1 0a2ef1c9 8b9ac8b5","7f1117a7 2bf2c7b9 e7c1ac4d 77fc94ca"],b:["3df91610 a83441ca ea9863bc 2ded5d5a","a8253aa1 0a2ef1c9 8b9ac8b5 7f1117a7","2bf2c7b9 e7c1ac4d 77fc94ca dc083e67","984050b7 5ebae5dd 2809bd63 8016f723"],n:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330870","553e5c41 4ca92619 41866119 7fac1047","1db1d381 085ddadd b5879682 9ca90069"],h:"1",z:"7",g:[["81aee4bd d82ed964 5a21322e 9c4c6a93","85ed9f70 b5d916c1 b43b62ee f4d0098e","ff3b1f78 e2d0d48d 50d1687b 93b97d5f","7c6d5047 406a5e68 8b352209 bcb9f822"],["7dde385d 566332ec c0eabfa9 cf7822fd","f209f700 24a57b1a a000c55b 881f8111","b2dcde49 4a5f485e 5bca4bd8 8a2763ae","d1ca2b2f a8f05406 78cd1e0f 3ad80892"],e]})}},X25519:class extends m{constructor(){super({id:"X25519",ossl:"X25519",type:"mont",endian:"le",hash:"SHA512",prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"76d06",b:"1",n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000009"],["5f51e65e 475f794b 1fe122d3 88b72eb3","6dc2b281 92839e4d d6163a5d 81312c14"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"],["6be4f497 f9a9c2af c21fa77a d7f4a6ef","635a11c7 284a9363 e9a248ef 9c884415"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"],["141b0b68 06563d50 3de05885 280b5910","9ca5ee38 d7b56c9c 165db710 6377bbd8"]],[["57119fd0 dd4e22d8 868e1c58 c45c4404","5bef839c 55b1d0b1 248c50a3 bc959c5f"],["68c59389 3d458e64 31c6ca00 45fb5015","20a44346 8eaa68dd 0f103842 048065b7"]],[["57119fd0 dd4e22d8 868e1c58 c45c4404","5bef839c 55b1d0b1 248c50a3 bc959c5f"],["173a6c76 c2ba719b ce3935ff ba04afea","df5bbcb9 71559722 f0efc7bd fb7f9a36"]],[["00b8495f 16056286 fdb1329c eb8d09da","6ac49ff1 fae35616 aeb8413b 7c7aebe0"],["3931c129 569e83a5 29482c14 e628b457","933bfc29 ed801b4d 68871483 92507b1a"]],[["00b8495f 16056286 fdb1329c eb8d09da","6ac49ff1 fae35616 aeb8413b 7c7aebe0"],["46ce3ed6 a9617c5a d6b7d3eb 19d74ba8","6cc403d6 127fe4b2 9778eb7c 6daf84d3"]]]})}},X448:class extends m{constructor(){super({id:"X448",ossl:"X448",type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"262a6",b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000005"],["7d235d12 95f5b1f6 6c98ab6e 58326fce","cbae5d34 f55545d0 60f75dc2 8df3f6ed","b8027e23 46430d21 1312c4b1 50677af7","6fd7223d 457b5b1a"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["ba4d3a08 29b6112f 8812e51b a0bb2abe","bc1cb08e b48e5569 36ba50fd d2e7d68a","f8cb3216 0522425b 3f990812 abbe635a","d37a21e1 7551b193"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["45b2c5f7 d649eed0 77ed1ae4 5f44d541","43e34f71 4b71aa96 c945af01 2d182975","0734cde9 faddbda4 c066f7ed 54419ca5","2c85de1e 8aae4e6c"]]]})}},MONT448:class extends m{constructor(){super({id:"MONT448",ossl:null,type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:["b2cf97d2 d43459a9 31ed36b1 fc4e3cb5","5d93f8d2 22746997 60ccffc6 49961ed6","c5b05fca c24864ed 6fb59697 931b78da","84ddecd8 ca2b5cfb"],b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["ac0d24cc c6c75cb0 eb71f81e 7a6edf51","48e88aee 009a2a24 e795687e c28e125a","3e6730a6 0d46367b aa7fe99d 152128dc","41321bc7 7817f059"],["5a4437f6 80c0d0db 9b061276 d5d0ffcc","e786ff33 b6a53d30 98746425 82e66f09","4433dae7 7244a6e2 6b11e905 7228f483","556c41a5 913f55fe"]],torsion:[[],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["bec92fd0 6da2acf2 b4e261e8 7cef0d34","22e75c18 3c589857 b71924e5 73c2f9ce","e18da5f2 466e2f39 3c2eedf0 f105a60a","b40c717d 4f1e1fd7"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["4136d02f 925d530d 4b1d9e17 8310f2cb","dd18a3e7 c3a767a8 48e6db19 8c3d0631","1e725a0d b991d0c6 c3d1120f 0efa59f5","4bf38e82 b0e1e028"]]]})}},ED25519:class extends w{constructor(e){super({id:"ED25519",ossl:"ED25519",type:"edwards",endian:"le",hash:"SHA512",prefix:"SigEd25519 no Ed25519 collisions",context:!1,prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"-1",d:["52036cee 2b6ffe73 8cc74079 7779e898","00700a4d 4141d8ab 75eb4dca 135978a3"],n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["216936d3 cd6e53fe c0a4e231 fdd6dc5c","692cc760 9525a7b2 c9562d60 8f25d51a"],["66666666 66666666 66666666 66666666","66666666 66666666 66666666 66666658"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffec"]],[["2b832480 4fc1df0b 2b4d0099 3dfbd7a7","2f431806 ad2fe478 c4ee1b27 4a0ea0b0"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["547cdb7f b03e20f4 d4b2ff66 c2042858","d0bce7f9 52d01b87 3b11e4d8 b5f15f3d"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000"]],[["1fd5b9a0 06394a28 e9339932 38de4abb","5c193c70 13e5e238 dea14646 c545d14a"],["05fc536d 880238b1 3933c6d3 05acdfd5","f098eff2 89f4c345 b027b2c2 8f95e826"]],[["602a465f f9c6b5d7 16cc66cd c721b544","a3e6c38f ec1a1dc7 215eb9b9 3aba2ea3"],["05fc536d 880238b1 3933c6d3 05acdfd5","f098eff2 89f4c345 b027b2c2 8f95e826"]],[["1fd5b9a0 06394a28 e9339932 38de4abb","5c193c70 13e5e238 dea14646 c545d14a"],["7a03ac92 77fdc74e c6cc392c fa53202a","0f67100d 760b3cba 4fd84d3d 706a17c7"]],[["602a465f f9c6b5d7 16cc66cd c721b544","a3e6c38f ec1a1dc7 215eb9b9 3aba2ea3"],["7a03ac92 77fdc74e c6cc392c fa53202a","0f67100d 760b3cba 4fd84d3d 706a17c7"]]]})}},ISO448:class extends w{constructor(e){super({id:"ISO448",ossl:null,type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["d78b4bdc 7f0daf19 f24f38c2 9373a2cc","ad461572 42a50f37 809b1da3 412a12e7","9ccc9c81 264cfe9a d0809970 58fb61c4","243cc32d baa156b9"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["79a70b2b 70400553 ae7c9df4 16c792c6","1128751a c9296924 0c25a07d 728bdc93","e21f7787 ed697224 9de732f3 8496cd11","69871309 3e9c04fc"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 80000000","00000000 00000000 00000000 00000000","00000000 00000001"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]]]})}},ED448:class extends w{constructor(e){super({id:"ED448",ossl:"ED448",type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffff6756"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["4f1970c6 6bed0ded 221d15a6 22bf36da","9e146570 470f1767 ea6de324 a3d3a464","12ae1af7 2ab66511 433b80e1 8b00938e","2626a82b c70cc05e"],["693f4671 6eb6bc24 88762037 56c9c762","4bea7373 6ca39840 87789c1e 05a0c2d7","3ad3ff1c e67c39c4 fdbd132c 4ed7c8ad","9808795b f230fa14"],e],torsion:[[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"],["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"]],[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000001"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]],[["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff fffffffe"],["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000"]]]})}}},_={__proto__:null,P192:null,P224:null,P256:null,P384:null,P521:null,SECP256K1:null,BRAINPOOLP256:null,BRAINPOOLP384:null,BRAINPOOLP512:null,X25519:null,X448:null,MONT448:null,ED25519:null,ISO448:null,ED448:null};function O(e,t,r){J(e instanceof f),J(!e.red),J(t>>>0===t),J(r>>>0===r);const i=new Array(r),s=e.bitLength()+1,n=1|e.sign();J(s<=r);for(let f=0;f<r;f++)i[f]=0;let d,o=0,h=0;for(;o<s;)e.bit(o)!==h?(d=e.bits(o,t)+h,h=d>>t-1&1,d-=h<<t,i[o]=n*d,o+=t):o+=1;return J(0===h),i}function E(e,t,r){const i=function(e,t,r){J(e instanceof f),J(t instanceof f),J(!e.red),J(!t.red),J(r>>>0===r);const i=[new Array(r),new Array(r)],s=Math.max(e.bitLength(),t.bitLength())+1,n=1|e.sign(),d=1|t.sign();J(s<=r);let o=0,h=0;for(let f=0;f<s;f++){const r=e.bits(f,3),s=t.bits(f,3);let u=(3&r)+o&3,c=(3&s)+h&3,l=0,a=0;if(3===u&&(u=-1),3===c&&(c=-1),1&u){const e=(7&r)+o&7;l=3!==e&&5!==e||2!==c?u:-u}if(1&c){const e=(7&s)+h&7;a=3!==e&&5!==e||2!==u?c:-c}i[0][f]=l*n,i[1][f]=a*d,2*o===l+1&&(o=1-o),2*h===a+1&&(h=1-h)}for(let f=s;f<r;f++)i[0][f]=0,i[1][f]=0;return i}(e,t,r),s=new Array(r);for(let f=0;f<r;f++){const e=i[0][f],t=i[1][f];s[f]=h[3*(e+1)+(t+1)]}return s}function J(e,t){if(!e){const e=new Error(t||"Assertion failed");throw Error.captureStackTrace&&Error.captureStackTrace(e,J),e}}function j(e){J(e instanceof f);try{return[1,e.redSqrt()]}catch(t){if("X is not a square mod P."===t.message)return[0,e.clone()];throw t}}function P(e,t){J(e instanceof f),J(t instanceof f);try{return[1,e.redDivSqrt(t)]}catch(r){if("Not invertible."===r.message||"X is not a square mod P."===r.message)return[0,e.clone()];throw r}}function R(e){const t=function(e){J(e instanceof f),J(e.red);const t=e.red.m;if(t.cmpn(3)<=0)return e.clone();if(2===t.modrn(3)){const r=t.ushln(1).isubn(1).idivn(3);return e.redPow(r)}const r=t.modrn(9);if(4===r){const r=t.ushln(1).iaddn(1).idivn(9),i=e.redPow(r);if(!i.redSqr().redMul(i).eq(e))throw new Error("X is not a cube mod P.");return i}if(7===r){const r=t.addn(2).idivn(9),i=e.redPow(r);if(!i.redSqr().redMul(i).eq(e))throw new Error("X is not a cube mod P.");return i}throw new Error("Not implemented.")}(e);if(1===e.red.m.modrn(3)){const r=new f(2).toRed(e.red),i=new f(3).toRed(e.red),s=r.redInvert(),n=i.redNeg().redSqrt().redMul(s),d=n.redNeg(),o=n.redSub(s),h=d.redSub(s),u=t.redMul(o),c=t.redMul(h);return[t,u,c]}return[t]}function F(e){for(const t of R(e))if(t.redJacobi()>=0)return t;throw new Error("X^(1/3) is not a square mod P.")}function Z(e){return f.randomBits(e,32).toNumber()}function X(e,t){const r=new WeakMap;return function(i,f){const s=1&f,n=r.get(i);if(n&&null!==n[s])return n[s];const d=e.call(t,i,f);return r.has(i)||r.set(i,[null,null]),r.get(i)[s]=d,d}}function D(e,t){J(e instanceof f),J(t>>>0===t),7&t&&(t+=8-(7&t));const r=e.toString(16,t),i=[],s=[];J(0===(7&r.length));for(let f=0;f<r.length;f+=8)i.push(r.slice(f,f+8));for(let f=0;f<i.length;f+=4)s.push(i.slice(f,f+4).join(" "));return s}t.Curve=c,t.Point=l,t.ShortCurve=a,t.ShortPoint=b,t.JPoint=p,t.MontCurve=m,t.MontPoint=S,t.XPoint=M,t.EdwardsCurve=w,t.EdwardsPoint=I,t.curves=q,t.curve=function(e,...t){J("string"===typeof e);const r=e.toUpperCase();let i=_[r];if(!i){const f=q[r];if(!f)throw new Error(`Curve not found: "${e}".`);i=new f(...t),_[r]=i}return i},t.register=function(e,t){J("string"===typeof e),J("function"===typeof t);const r=e.toUpperCase();if(q[r])throw new Error(`Curve already registered: "${e}".`);q[r]=t,_[r]=null}}).call(this,r("HDXh").Buffer)}}]);